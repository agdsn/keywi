(function(){var e={55726:function(e,t,n){"use strict";n(66992),n(88674),n(19601),n(17727);var a=n(20144),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-main",[n("app-header"),n("v-container",[n("router-view")],1)],1)],1)},o=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("app-title",{attrs:{"view-title":e.$route.meta.title}}),n("app-nav-bar")],1)},s=[],l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v(" "+e._s(e.viewTitle)+" ")])])},c=[],u=a.Z.extend({name:"AppTitle",props:["viewTitle"]}),d=u,m=n(1001),f=(0,m.Z)(d,l,c,!1,null,"7bc69db0",null),v=f.exports,p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"nav-bar"},[n("ul",{staticClass:"list left"},[n("li",[n("router-link",{attrs:{to:"/key"}},[n("v-icon",{attrs:{color:"white",left:""}},[e._v("mdi-key-chain")]),e._v(" Schlüssel ")],1)],1),n("li",[n("router-link",{attrs:{to:"/safe"}},[n("v-icon",{attrs:{color:"white",left:""}},[e._v("mdi-safe-square")]),e._v(" Tresore ")],1)],1),n("li",[n("router-link",{attrs:{to:"/lock"}},[n("v-icon",{attrs:{color:"white",left:""}},[e._v("mdi-lock")]),e._v(" Schlösser ")],1)],1),n("li",[n("router-link",{attrs:{to:"/location"}},[n("v-icon",{attrs:{color:"white",left:""}},[e._v("mdi-map-marker")]),e._v(" Orte ")],1)],1),n("li",[n("router-link",{attrs:{to:"/user"}},[n("v-icon",{attrs:{color:"white",left:""}},[e._v("mdi-account-multiple")]),e._v(" Benutzer ")],1)],1),n("li",[n("router-link",{attrs:{to:"/rental"}},[n("v-icon",{attrs:{color:"white",left:""}},[e._v("mdi-hand-coin")]),e._v(" Ausleihen ")],1)],1),n("li",[n("router-link",{attrs:{to:"/log"}},[n("v-icon",{attrs:{color:"white",left:""}},[e._v("mdi-format-list-bulleted-type")]),e._v(" Logs ")],1)],1)]),n("ul",{staticClass:"list"},[e.loggedIn?n("li",[null!=e.user?n("router-link",{staticClass:"mr-8",attrs:{to:"/user/"+e.user.id,href:"#"}},[n("v-icon",{attrs:{color:"white",left:""}},[e._v("mdi-account")]),e._v(" "+e._s(e.user.login)+" ")],1):e._e(),n("a",{on:{click:e.logout}},[n("v-icon",{attrs:{color:"white",left:""}},[e._v("mdi-logout")]),e._v(" Logout ")],1)],1):n("li",[n("a",{on:{click:function(t){return e.$refs.loginDialog.openDialog()}}},[n("v-icon",{attrs:{color:"white",left:""}},[e._v("mdi-login")]),e._v(" Login ")],1)])]),n("form-popup",{ref:"loginDialog",attrs:{"hide-btn":"",form:"login-form",text:"Login"},on:{"save-form":e.checkLogin}})],1)},h=[],k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{attrs:{"max-width":"600px"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[e.hideBtn?e._e():n("v-btn",e._g({staticClass:"mx-8 my-4",attrs:{title:e.tooltip,disabled:e.disabled,color:"secondary"},on:{click:function(t){return e.$emit("button-add-clicked")}}},a),[e.icon?n("v-icon",{attrs:{left:"",size:"24"}},[e._v(e._s(e.icon))]):e._e(),e._v(" "+e._s(e.text)+" ")],1)]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("h2",[e._v(e._s(e.text))])]),n("v-card-text",{staticClass:"pb-10"},[n(e.form,{ref:"form",tag:"component",staticClass:"mx-8 my-4",on:{"save-form":e.saveForm,mounted:e.mountedEvent}})],1)],1)],1)},g=[],b={name:"FormPopup",props:{text:String,hideBtn:{type:Boolean,default:!1},form:String,disabled:{default:!1},tooltip:{default:""},icon:String},data:function(){return{dialog:!1}},methods:{closeDialog:function(){this.dialog=!1},openDialog:function(){this.dialog=!0},saveForm:function(){this.$emit("save-form"),this.closeDialog()},mountedEvent:function(){this.$emit("mounted")},buttonClicked:function(){console.log("button clicked")}}},_=b,y=n(43453),x=n.n(y),D=n(680),w=n(32371),S=n(37118),Z=n(67336),$=n(96428),E=(0,m.Z)(_,k,g,!1,null,"1a686ca3",null),T=E.exports;x()(E,{VBtn:D.Z,VCard:w.Z,VCardText:S.ZB,VCardTitle:S.EB,VDialog:Z.Z,VIcon:$.Z});var V=n(16198),C=(n(35666),n(38862),n(92222),n(80129)),R=n.n(C),I=n(28418),L=n.n(I),A={},B=localStorage.getItem("access_token");function z(){var e=new(L())({definition:"".concat("https://keywi.agdsn.de/api","/openapi.json"),withServer:"main",axiosConfigDefaults:{headers:A}}).init();return e}null!=B&&(A={Authorization:"Bearer ".concat(B)});var F=z(),U=n(9669),N=n.n(U),K={setAccessToken:function(e){return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:return n=t.sent,a="Bearer ".concat(e),N().defaults.headers.common.Authorization=a,n.defaults.headers.Authorization=a,t.next=8,n.user_getCurrent();case 8:return r=t.sent.data,localStorage.setItem("user",JSON.stringify(r)),localStorage.setItem("access_token",e),window.dispatchEvent(new CustomEvent("keywi-auth-change",{})),t.abrupt("return",!0);case 13:case"end":return t.stop()}}),t)})))()},login:function(e,t){var n=this;return(0,V.Z)(regeneratorRuntime.mark((function a(){var r,o,i,s,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,F;case 2:return r=a.sent,o={username:e,password:t},i=R().stringify(o),s={headers:{"content-type":"application/x-www-form-urlencoded"},data:i},a.next=8,r.auth_getToken(null,o,s);case 8:return l=a.sent.data.access_token,a.next=11,n.setAccessToken(l);case 11:return a.abrupt("return",!0);case 12:case"end":return a.stop()}}),a)})))()},logout:function(){return(0,V.Z)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,F;case 2:t=e.sent,localStorage.removeItem("access_token"),localStorage.removeItem("user"),delete N().defaults.headers.common.Authorization,delete t.defaults.headers.Authorization,window.dispatchEvent(new CustomEvent("keywi-auth-change",{}));case 8:case"end":return e.stop()}}),e)})))()},getOAuthUrl:function(e){var t=e,n="".concat("https://keywi.agdsn.de/api","/auth/start");null==e&&(t=window.location.origin);var a=encodeURIComponent(t);return n=n.concat("?return_url=".concat(a)),n},isLoggedIn:function(){return null!=localStorage.getItem("access_token")},getUser:function(){var e=localStorage.getItem("user");return null==e?null:JSON.parse(e)}},O=(n(68309),n(78345)),P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("key-table",{ref:"keyTable",staticClass:"mx-7 mt-7",on:{editItem:e.editKey}}),n("v-divider",{staticClass:"mx-8"}),n("form-popup",{ref:"popup",attrs:{text:"Schlüssel hinzufügen",form:"edit-key-form",icon:"mdi-plus"},on:{"save-form":function(t){return e.$refs.keyTable.loadData()},mounted:e.mountedEvent,"button-add-clicked":e.buttonAddClicked}})],1)},M=[],j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("DataTable",{ref:"table",staticClass:"elevation-1",attrs:{headers:e.headers,"item-class":e.row_classes,items:e.tableData,"multi-sort":"","sort-by":["location.name","lock.name","number"],"loading-text":"Lade Daten..."},scopedSlots:e._u([{key:"header",fn:function(){return[n("h2",{staticClass:"ml-4"},[e._v("Schlüssel")])]},proxy:!0},{key:"item.link",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/key/"+a.id}},[n("v-icon",{attrs:{small:""}},[e._v(" mdi-open-in-new ")])],1)]}},{key:"item.number",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/key/"+a.id}},[e._v(e._s(a.number))])]}},{key:"item.lock.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/lock/"+a.lock.id}},[e._v(e._s(a.lock.name))])]}},{key:"item.safe.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/safe/"+a.safe.id}},[e._v(e._s(a.safe.name))])]}},{key:"item.location.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/location/"+a.location.id}},[e._v(e._s(a.location.name))])]}},{key:"item.rental",fn:function(t){var n=t.item;return[e._v(" "+e._s(e.getRentalStatus(n))+" ")]}},{key:"item.actions",fn:function(t){var a=t.item;return[n("div",{staticClass:"text-right"},[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(a)}}},[e._v(" mdi-pencil ")]),n("v-icon",{attrs:{small:""},on:{click:function(t){return e.openDeletePrompt(a)}}},[e._v(" mdi-delete ")]),e.rentable(a)||e.rentedByUser(a)?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[n("v-icon",e._g({staticClass:"ml-2",attrs:{color:e.getKeyColor(a),small:""},on:{click:function(t){return e.openRentPrompt(a)}}},r),[e._v(" mdi-hand-coin ")])]}}],null,!0)},[n("span",[e._v(e._s(e.getTooltip(a)))])]):e._e()],1)]}}],null,!0)}),n("v-dialog",{attrs:{width:"500px"},model:{value:e.deleteDialog,callback:function(t){e.deleteDialog=t},expression:"deleteDialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Schlüssel "+e._s(e.keyInDialogNumber)+" wirklich löschen?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.deleteItem}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-delete")]),e._v(" Bestätigen ")],1)],1)],1)],1),n("v-dialog",{attrs:{width:"500px"},model:{value:e.returnDialog,callback:function(t){e.returnDialog=t},expression:"returnDialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Schlüssel "+e._s(e.keyInDialogNumber)+" wirklich zurückgeben?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.returnItem}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-content-save-outline")]),e._v(" Bestätigen ")],1)],1)],1)],1),n("v-dialog",{ref:"rentForm",attrs:{width:"500px"},model:{value:e.rentDialog,callback:function(t){e.rentDialog=t},expression:"rentDialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Schlüssel "+e._s(e.keyInDialogNumber)+" wirklich ausleihen?")]),n("v-card-text",[n("v-form",{ref:"form"},[n("v-autocomplete",{attrs:{"item-text":function(e){return e.name},items:e.users,rules:e.userRules,label:"Vergeben an","prepend-icon":"mdi-account","return-object":""},model:{value:e.pickedUser,callback:function(t){e.pickedUser=t},expression:"pickedUser"}}),n("v-text-field",{attrs:{label:"Dokument","prepend-icon":"mdi-file-document"},model:{value:e.grantingDocument,callback:function(t){e.grantingDocument=t},expression:"grantingDocument"}}),n("v-textarea",{attrs:{label:"Notiz","prepend-icon":"mdi-note-text-outline",rows:"1"},model:{value:e.note,callback:function(t){e.note=t},expression:"note"}}),n("v-checkbox",{attrs:{label:"Startdatum bearbeiten"},model:{value:e.editStartDate,callback:function(t){e.editStartDate=t},expression:"editStartDate"}}),n("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({staticStyle:{"margin-top":"-10px"},attrs:{disabled:!e.editStartDate,label:"Startdatum","prepend-icon":"mdi-calendar",readonly:""},model:{value:e.dateStart,callback:function(t){e.dateStart=t},expression:"dateStart"}},"v-text-field",r,!1),a))]}}]),model:{value:e.menuStartDate,callback:function(t){e.menuStartDate=t},expression:"menuStartDate"}},[n("v-date-picker",{on:{input:function(t){e.menuStartDate=!1}},model:{value:e.dateStart,callback:function(t){e.dateStart=t},expression:"dateStart"}})],1),n("v-checkbox",{attrs:{label:"Enddatum bearbeiten"},model:{value:e.editEndDate,callback:function(t){e.editEndDate=t},expression:"editEndDate"}}),n("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({staticStyle:{"margin-top":"-10px"},attrs:{disabled:!e.editEndDate,label:"Enddatum","prepend-icon":"mdi-calendar",readonly:""},model:{value:e.dateEnd,callback:function(t){e.dateEnd=t},expression:"dateEnd"}},"v-text-field",r,!1),a))]}}]),model:{value:e.menuEndDate,callback:function(t){e.menuEndDate=t},expression:"menuEndDate"}},[n("v-date-picker",{on:{input:function(t){e.menuEndDate=!1}},model:{value:e.dateEnd,callback:function(t){e.dateEnd=t},expression:"dateEnd"}})],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.rentKey}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-content-save-outline")]),e._v(" Speichern ")],1)],1)],1)],1)],1)},q=[],G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-data-table",e._g(e._b({staticClass:"elevation-1",attrs:{items:e.realItems,search:e.externalSearch?null:e.searchModel,loading:e.loading,"loading-text":"Lade Daten...","items-per-page":15,"item-key":e.itemKey,"footer-props":e.footerProps},scopedSlots:e._u([{key:"top",fn:function(){return[n("v-row",[n("v-col",{attrs:{"align-self":"start"}},[e._t("header")],2),e.$slots.header||e.$scopedSlots.header?e._e():n("v-spacer"),e.showSearch||e.externalSearch?n("v-col",{attrs:{lg:"3",md:"6",sm:"12","align-self":"center"}},[n("v-text-field",{staticClass:"mr-4 ml-4",attrs:{label:"Search","hide-details":"",outlined:"",dense:""},on:{input:function(t){return e.$emit("search",e.searchModel)}},scopedSlots:e._u([{key:"prepend-inner",fn:function(){return[n("v-icon",[e._v(" mdi-magnify ")])]},proxy:!0}],null,!1,2092382991),model:{value:e.searchModel,callback:function(t){e.searchModel=t},expression:"searchModel"}})],1):e._e()],1)]},proxy:!0},{key:"footer.page-text",fn:function(){return[n("v-row",[n("v-col",{attrs:{"align-self":"center"}},[e._t("footer-right")],2)],1)]},proxy:!0},e._l(e.inheritSlots,(function(t,n){return{key:n,fn:function(t){return[e._t(n,null,null,t)]}}}))],null,!0)},"v-data-table",e.$attrs,!1),e.$listeners))},J=[],W={name:"DataTable",data:function(){return{searchModel:null}},props:{externalSearch:{type:Boolean,default:!1},items:Array,showSearch:{type:Boolean,default:!0},itemKey:{type:String,default:"id"},footerProps:{type:Object,default:function(){return{"items-per-page-options":[5,10,15,25,50]}}}},computed:{loading:function(){return null==this.items},inheritSlots:function(){var e=this.$scopedSlots;return"header"in e&&delete e.header,e},realItems:function(){return this.items?this.items:[]}},watch:{searchModel:function(){this.$emit("update:search",this.searchModel)}}},H=W,Y=n(82102),Q=n(49808),X=n(62877),ee=n(99762),te=n(55978),ne=(0,m.Z)(H,G,J,!1,null,null,null),ae=ne.exports;x()(ne,{VCol:Y.Z,VDataTable:Q.Z,VIcon:$.Z,VRow:X.Z,VSpacer:ee.Z,VTextField:te.Z});var re={name:"KeyTable",components:{DataTable:ae},data:function(){return{keyInDialog:void 0,deleteDialog:!1,rentDialog:!1,returnDialog:!1,grantingDocument:"",note:"",menuStartDate:!1,editStartDate:!1,dateStart:void 0,menuEndDate:!1,editEndDate:!1,dateEnd:void 0,headers:[{width:"5%",text:"Link",value:"link"},{text:"Ort",value:"location.name"},{text:"Schloss",value:"lock.name"},{text:"Schlüsselnummer",value:"number"},{text:"Tresor",value:"safe.name"},{text:"Ausleihe",value:"rental"},{text:"Aktionen",value:"actions",width:"200px",sortable:!1,align:"right"}],tableData:null,usersLoaded:!1,users:[],pickedUser:void 0,userRules:[function(e){return!!e||"Bitte Nutzer auswählen"}],keyId:void 0}},mounted:function(){this.loadData()},methods:{loadData:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.$route.params.id,t.next=3,F;case 3:a=t.sent,n?a.key_getKey(n).then((function(t){e.tableData=[t.data]})):a.key_getKeys().then((function(t){e.tableData=t.data}));case 5:case"end":return t.stop()}}),t)})))()},editItem:function(e){this.$emit("editItem",e)},openDeletePrompt:function(e){this.keyInDialog=e,this.deleteDialog=!0},openRentPrompt:function(e){this.keyInDialog=e,this.editStartDate=!1,this.editEndDate=!1,this.rentedByUser(e)?this.returnDialog=!0:(this.loadUsers(),this.rentDialog=!0,this.grantingDocument="",this.note="",this.dateStart="",this.dateEnd="",this.pickedUser=void 0)},loadUsers:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.usersLoaded){t.next=2;break}return t.abrupt("return");case 2:return e.usersLoaded=!0,t.next=5,F;case 5:n=t.sent,n.user_getUsers().then((function(t){e.users=t.data}));case 7:case"end":return t.stop()}}),t)})))()},deleteItem:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,a={uuid:e.keyInDialog.id},n.key_deleteKey(a).then((function(){e.deleteDialog=!1,e.loadData()}));case 5:case"end":return t.stop()}}),t)})))()},returnItem:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,a={uuid:e.keyInDialog.active_rental.id},n.rental_endRental(a).then((function(){e.returnDialog=!1,e.loadData()}));case 5:case"end":return t.stop()}}),t)})))()},dateToDatetime:function(e){return e+"T12:37"},rentKey:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()){t.next=8;break}return t.next=3,F;case 3:n=t.sent,a={key_id:e.keyInDialog.id,user_id:e.pickedUser.id,allowed_by:e.grantingDocument,note:e.note},e.editStartDate&&e.dateStart&&(a.begin=e.dateToDatetime(e.dateStart)),e.editEndDate&&e.dateEnd&&(a.end=e.dateToDatetime(e.dateEnd)),n.rental_createRental(null,a).then((function(){e.rentDialog=!1,e.$refs.form.resetValidation(),e.pickedUser=void 0,e.loadData()}));case 8:case"end":return t.stop()}}),t)})))()},getRentalStatus:function(e){return this.rentedByUser(e)?"Ausgeliehen (von dir)":e.active_rental?"Ausgeliehen":e.rentable?"Ausleihbar":"Nicht ausleihbar"},rentable:function(e){return"Ausleihbar"==this.getRentalStatus(e)},row_classes:function(e){return null==e.active_rental&&e.rentable?"green-cell":e.rentable?"red-cell":"grey-cell"},getKeyColor:function(e){return"initial"},getTooltip:function(e){return this.rentedByUser(e)?"Schlüssel zurückgeben":"Schlüssel ausleihen"},rentedByUser:function(e){if(!e.active_rental)return!1;var t=K.getUser();return t.id==e.active_rental.user_id}},computed:{keyInDialogNumber:function(){return this.keyInDialog?this.keyInDialog.number:""}}},oe=re,ie=n(71835),se=n(69362),le=n(99094),ce=n(46232),ue=n(41152),de=n(34350),me=n(19330),fe=(0,m.Z)(oe,j,q,!1,null,"225a1c08",null),ve=fe.exports;x()(fe,{VAutocomplete:ie.Z,VBtn:D.Z,VCard:w.Z,VCardActions:S.h7,VCardText:S.ZB,VCardTitle:S.EB,VCheckbox:se.Z,VDatePicker:le.Z,VDialog:Z.Z,VForm:ce.Z,VIcon:$.Z,VMenu:ue.Z,VSpacer:ee.Z,VTextField:te.Z,VTextarea:de.Z,VTooltip:me.Z});var pe=a.Z.extend({name:"AllKeysView",components:{KeyTable:ve,FormPopup:T},data:function(){return{editedKey:void 0}},methods:{editKey:function(e){this.editedKey=e,this.$refs.popup.openDialog(),this.$refs.popup.$refs.form&&this.$refs.popup.$refs.form.fillForm(this.editedKey)},mountedEvent:function(){this.$refs.popup.$refs.form.fillForm(this.editedKey)},buttonAddClicked:function(){this.editedKey=void 0,this.$refs.popup.$refs.form&&this.$refs.popup.$refs.form.fillForm(this.editedKey)}}}),he=pe,ke=n(11418),ge=(0,m.Z)(he,P,M,!1,null,"62115910",null),be=ge.exports;x()(ge,{VDivider:ke.Z});var _e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("safe-table",{ref:"safeTable",staticClass:"mx-7 mt-7",on:{editItem:e.editSafe}}),n("v-divider",{staticClass:"mx-8"}),n("form-popup",{ref:"popup",attrs:{text:"Tresor hinzufügen",form:"edit-safe-form",icon:"mdi-plus"},on:{"save-form":function(t){return e.$refs.safeTable.loadData()},mounted:e.mountedEvent,"button-add-clicked":e.buttonAddClicked}})],1)},ye=[],xe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("DataTable",{ref:"table",attrs:{headers:e.headers,items:e.tableData,"sort-by":"name"},scopedSlots:e._u([{key:"header",fn:function(){return[n("h2",{staticClass:"ml-4"},[e._v("Tresore")])]},proxy:!0},{key:"item.location.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/location/"+a.location.id}},[e._v(e._s(a.location.name))])]}},{key:"item.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/safe/"+a.id}},[e._v(e._s(a.name))])]}},{key:"item.actions",fn:function(t){var a=t.item;return[n("div",{staticClass:"text-right"},[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(a)}}},[e._v(" mdi-pencil ")]),n("v-icon",{attrs:{small:""},on:{click:function(t){return e.openDeletePrompt(a)}}},[e._v(" mdi-delete ")])],1)]}}],null,!0)}),n("v-dialog",{attrs:{width:"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Tresor "+e._s(e.safeToDeleteName)+" wirklich löschen?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.deleteItem}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-delete")]),e._v(" Bestätigen ")],1)],1)],1)],1)],1)},De=[],we={name:"SafeTable",components:{DataTable:ae},data:function(){return{dialog:!1,safeToDelete:void 0,headers:[{text:"Tresor",value:"name"},{text:"Ort",value:"location.name"},{text:"Anzahl Schlüssel",value:"amount_keys"},{text:"Aktionen",value:"actions",width:"200px",sortable:!1,align:"right"}],tableData:null}},mounted:function(){this.loadData()},computed:{safeToDeleteName:function(){return this.safeToDelete?this.safeToDelete.name:""}},methods:{loadData:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.$route.params.id,t.next=3,F;case 3:a=t.sent,n?a.safe_getSafe(n).then((function(t){e.tableData=[t.data]})):a.safe_getSafes().then((function(t){e.tableData=t.data}));case 5:case"end":return t.stop()}}),t)})))()},editItem:function(e){this.$emit("editItem",e)},openDeletePrompt:function(e){this.safeToDelete=e,this.dialog=!0},deleteItem:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,a={uuid:e.safeToDelete.id},n.safe_deleteSafe(a).then((function(){e.dialog=!1,e.loadData()}));case 5:case"end":return t.stop()}}),t)})))()}}},Se=we,Ze=(0,m.Z)(Se,xe,De,!1,null,null,null),$e=Ze.exports;x()(Ze,{VBtn:D.Z,VCard:w.Z,VCardActions:S.h7,VCardTitle:S.EB,VDialog:Z.Z,VIcon:$.Z,VSpacer:ee.Z});var Ee=a.Z.extend({name:"AllSafesView",components:{SafeTable:$e,FormPopup:T},data:function(){return{editedSafe:void 0}},methods:{editSafe:function(e){this.editedSafe=e,this.$refs.popup.openDialog(),this.$refs.popup.$refs.form&&this.$refs.popup.$refs.form.fillForm(this.editedSafe)},mountedEvent:function(){this.$refs.popup.$refs.form.fillForm(this.editedSafe)},buttonAddClicked:function(){this.editedSafe=void 0,this.$refs.popup.$refs.form&&this.$refs.popup.$refs.form.fillForm(this.editedSafe)}}}),Te=Ee,Ve=(0,m.Z)(Te,_e,ye,!1,null,"5300266c",null),Ce=Ve.exports;x()(Ve,{VDivider:ke.Z});var Re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("lock-table",{ref:"lockTable",staticClass:"mx-7 mt-7",on:{editItem:e.editLock}}),n("v-divider",{staticClass:"mx-8"}),n("form-popup",{ref:"popup",attrs:{form:"edit-lock-form",icon:"mdi-plus",text:"Schloss hinzufügen"},on:{mounted:e.mountedEvent,"save-form":function(t){return e.$refs.lockTable.loadData()},"button-add-clicked":e.buttonAddClicked}})],1)},Ie=[],Le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("DataTable",{ref:"table",staticClass:"elevation-1",attrs:{headers:e.headers,items:e.tableData,"multi-sort":"","sort-by":["location.name","name"],"loading-text":"Lade Daten..."},scopedSlots:e._u([{key:"header",fn:function(){return[n("h2",{staticClass:"ml-4"},[e._v("Schlösser")])]},proxy:!0},{key:"item.link",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/lock/"+a.id}},[n("v-icon",{attrs:{small:""}},[e._v(" mdi-open-in-new ")])],1)]}},{key:"item.location.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/location/"+a.location.id}},[e._v(e._s(a.location.name))])]}},{key:"item.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/lock/"+a.id}},[e._v(e._s(a.name))])]}},{key:"item.available_keys",fn:function(t){var n=t.item;return[e._v(" "+e._s(n.amount_free_keys)+" / "+e._s(n.amount_keys)+" ")]}},{key:"item.actions",fn:function(t){var a=t.item;return[n("div",{staticClass:"text-right"},[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(a)}}},[e._v(" mdi-pencil ")]),n("v-icon",{attrs:{small:""},on:{click:function(t){return e.openDeletePrompt(a)}}},[e._v(" mdi-delete ")])],1)]}}],null,!0)}),n("v-dialog",{attrs:{width:"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Schloss "+e._s(e.lockToDeleteName)+" wirklich löschen?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.deleteItem}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-delete")]),e._v(" Bestätigen ")],1)],1)],1)],1)],1)},Ae=[],Be={name:"LockTable",components:{DataTable:ae},data:function(){return{dialog:!1,lockToDelete:void 0,headers:[{width:"5%",text:"Link",value:"link"},{text:"Ort",value:"location.name"},{text:"Schloss",value:"name"},{text:"Besitzer",value:"owner"},{text:"Verfügbare Schlüssel",value:"available_keys"},{text:"Aktionen",value:"actions",width:"200px",sortable:!1,align:"right"}],tableData:null}},computed:{lockToDeleteName:function(){return this.lockToDelete?this.lockToDelete.name:""}},mounted:function(){this.loadData()},methods:{loadData:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.$route.params.id,t.next=3,F;case 3:a=t.sent,n?a.lock_getLock(n).then((function(t){e.tableData=[t.data]})):a.lock_getLocks().then((function(t){e.tableData=t.data}));case 5:case"end":return t.stop()}}),t)})))()},editItem:function(e){this.$emit("editItem",e)},openDeletePrompt:function(e){this.lockToDelete=e,this.dialog=!0},deleteItem:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,a={uuid:e.lockToDelete.id},n.lock_deleteLock(a).then((function(){e.dialog=!1,e.loadData()}));case 5:case"end":return t.stop()}}),t)})))()}}},ze=Be,Fe=(0,m.Z)(ze,Le,Ae,!1,null,null,null),Ue=Fe.exports;x()(Fe,{VBtn:D.Z,VCard:w.Z,VCardActions:S.h7,VCardTitle:S.EB,VDialog:Z.Z,VIcon:$.Z,VSpacer:ee.Z});var Ne=a.Z.extend({name:"AllLocksView",components:{LockTable:Ue,FormPopup:T},data:function(){return{editedLock:void 0}},methods:{editLock:function(e){this.editedLock=e,this.$refs.popup.openDialog(),this.$refs.popup.$refs.form&&this.$refs.popup.$refs.form.fillForm(this.editedLock)},mountedEvent:function(){this.$refs.popup.$refs.form.fillForm(this.editedLock)},buttonAddClicked:function(){this.editedLock=void 0,this.$refs.popup.$refs.form&&this.$refs.popup.$refs.form.fillForm(this.editedLock)}}}),Ke=Ne,Oe=(0,m.Z)(Ke,Re,Ie,!1,null,"4994f2ba",null),Pe=Oe.exports;x()(Oe,{VDivider:ke.Z});var Me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home pb-5"},[n("location-table",{ref:"locationTable",staticClass:"mx-7 mt-7",on:{editItem:e.editLocation}}),n("form-popup",{ref:"popup",attrs:{text:"Ort hinzufügen",form:"edit-location-form",icon:"mdi-plus"},on:{"save-form":function(t){return e.$refs.locationTable.loadData()},mounted:e.mountedEvent,"button-add-clicked":e.buttonAddClicked}})],1)},je=[],qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("DataTable",{ref:"table",staticClass:"elevation-1",attrs:{headers:e.headers,items:e.tableData,"sort-by":"name"},scopedSlots:e._u([{key:"header",fn:function(){return[n("h2",{staticClass:"ml-4"},[e._v("Orte")])]},proxy:!0},{key:"item.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/location/"+a.id}},[e._v(e._s(a.name))])]}},{key:"item.actions",fn:function(t){var a=t.item;return[n("div",{staticClass:"text-right"},[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(a)}}},[e._v(" mdi-pencil ")]),n("v-icon",{attrs:{small:""},on:{click:function(t){return e.openDeletePrompt(a)}}},[e._v(" mdi-delete ")])],1)]}}],null,!0)}),n("v-dialog",{attrs:{width:"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Ort "+e._s(e.locationToDeleteName)+" wirklich löschen?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.deleteItem}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-delete")]),e._v(" Bestätigen ")],1)],1)],1)],1)],1)},Ge=[],Je={name:"LocationTable",components:{DataTable:ae},data:function(){return{dialog:!1,locationToDelete:void 0,headers:[{text:"Ort",value:"name"},{text:"Adresse",value:"address"},{text:"Anzahl Tresore",value:"amount_safes"},{text:"Anzahl Schlösser",value:"amount_locks"},{text:"Aktionen",value:"actions",width:"200px",sortable:!1,align:"right"}],tableData:null}},mounted:function(){this.loadData()},computed:{locationToDeleteName:function(){return this.locationToDelete?this.locationToDelete.name:""}},methods:{loadData:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.$route.params.id,t.next=3,F;case 3:a=t.sent,n?a.location_getLocation(n).then((function(t){e.tableData=[t.data]})):a.location_getLocations().then((function(t){e.tableData=t.data}));case 5:case"end":return t.stop()}}),t)})))()},editItem:function(e){this.$emit("editItem",e)},openDeletePrompt:function(e){this.locationToDelete=e,this.dialog=!0},deleteItem:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,a={uuid:e.locationToDelete.id},n.location_deleteLocation(a).then((function(){e.dialog=!1,e.loadData()}));case 5:case"end":return t.stop()}}),t)})))()}}},We=Je,He=(0,m.Z)(We,qe,Ge,!1,null,null,null),Ye=He.exports;x()(He,{VBtn:D.Z,VCard:w.Z,VCardActions:S.h7,VCardTitle:S.EB,VDialog:Z.Z,VIcon:$.Z,VSpacer:ee.Z});var Qe=a.Z.extend({name:"AllLocationsView",components:{FormPopup:T,LocationTable:Ye},data:function(){return{editedLocation:void 0}},methods:{editLocation:function(e){this.editedLocation=e,this.$refs.popup.openDialog(),this.$refs.popup.$refs.form&&this.$refs.popup.$refs.form.fillForm(this.editedLocation)},mountedEvent:function(){this.$refs.popup.$refs.form.fillForm(this.editedLocation)},buttonAddClicked:function(){this.editedLocation=void 0,this.$refs.popup.$refs.form&&this.$refs.popup.$refs.form.fillForm(this.editedLocation)}}}),Xe=Qe,et=(0,m.Z)(Xe,Me,je,!1,null,"b6037bf8",null),tt=et.exports,nt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("user-table",{staticClass:"mx-7 mt-7"})],1)},at=[],rt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("DataTable",{ref:"table",attrs:{headers:e.headers,items:e.tableData,"sort-by":"name"},scopedSlots:e._u([{key:"header",fn:function(){return[n("h2",{staticClass:"ml-4"},[e._v("Benutzer")])]},proxy:!0},{key:"item.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/user/"+a.id}},[e._v(e._s(a.name))])]}}],null,!0)})],1)},ot=[],it={name:"UserTable",components:{DataTable:ae},data:function(){return{headers:[{text:"Name",value:"name"},{text:"Nutzername",value:"login"},{text:"Mail-Adresse",value:"email"}],tableData:null}},mounted:function(){this.loadData()},methods:{loadData:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.$route.params.id,t.next=3,F;case 3:a=t.sent,n?a.user_getUser(n).then((function(t){e.tableData=[t.data]})):a.user_getUsers().then((function(t){e.tableData=t.data}));case 5:case"end":return t.stop()}}),t)})))()}}},st=it,lt=(0,m.Z)(st,rt,ot,!1,null,"ec3258ce",null),ct=lt.exports,ut=a.Z.extend({name:"AllUsersView",components:{UserTable:ct}}),dt=ut,mt=(0,m.Z)(dt,nt,at,!1,null,"4b45231e",null),ft=mt.exports,vt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{staticClass:"home pb-5 pt-1"},[n("div",{staticClass:"mx-8"},[n("h2",{staticClass:"my-2"},[e._v("Nutzer Daten")]),n("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[n("tbody",[n("tr",[n("td",{staticStyle:{width:"20%"}},[e._v("Name")]),n("td",[n("b",[e._v(e._s(e.user.name))])])]),n("tr",[n("td",[e._v("Loginname")]),n("td",[e._v(" "+e._s(e.user.login)+" ")])]),n("tr",[n("td",[e._v("Mail-Adresse")]),n("td",[e._v(" "+e._s(e.user.email)+" ")])]),n("tr",[n("td",[e._v("Notiz")]),n("td",[e._v(e._s(e.user.note))])])])]},proxy:!0}])}),n("v-divider"),n("div",{staticClass:"buttons"},[n("v-btn",{staticClass:"mx-8 my-4",attrs:{color:"secondary"},on:{click:e.downloadProtocol}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-file-download")]),e._v(" Protokoll ")],1)],1),n("detail-table-rentals",{ref:"rentalTable",staticClass:"mt-10"}),n("detail-table-logs",{ref:"logTable",staticClass:"mt-10"})],1)])},pt=[],ht=(n(41539),n(78783),n(33948),n(60285),n(41637),n(83112),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("DataTable",{ref:"table",attrs:{headers:e.headers,items:e.tableData,"sort-by":"begin","sort-desc":!0},scopedSlots:e._u([{key:"header",fn:function(){return[n("h2",{staticClass:"ml-4"},[e._v("Ausleihen")])]},proxy:!0},{key:"item.begin",fn:function(t){var n=t.item;return[e._v(" "+e._s(new Date(n.begin).toLocaleString("de"))+" ")]}},{key:"item.end",fn:function(t){var a=t.item;return[null!=a.end?n("span",[e._v(" "+e._s(new Date(a.end).toLocaleString("de"))+" ")]):n("span",[e._v(" - ")])]}},{key:"item.key.lock.location",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/location/"+a.key.lock.location.id}},[e._v(e._s(a.key.lock.location.name))])]}},{key:"item.key.lock",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/lock/"+a.key.lock.id}},[e._v(e._s(a.key.lock.name))])]}},{key:"item.key",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/key/"+a.key.id}},[e._v(e._s(a.key.number))])]}},{key:"item.user.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/user/"+a.user.id}},[e._v(e._s(a.user.name))])]}},{key:"item.actions",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/rental/"+a.id}},[n("v-icon",{staticClass:"mr-2",attrs:{small:""}},[e._v(" mdi-open-in-new ")])],1)]}}],null,!0)})}),kt=[],gt=(n(69826),n(40561),{name:"DetailTableKeys",components:{DataTable:ae},data:function(){return{headers:[{text:"Links",value:"actions",width:"5%",sortable:!1},{text:"Ort",value:"key.lock.location"},{text:"Schloss",value:"key.lock"},{text:"Schlüsselnummer",value:"key"},{text:"Ausgeliehen von",value:"user.name"},{text:"Beginn",value:"begin"},{text:"Ende",value:"end"}],tableData:null}},methods:{loadDataByKeyId:function(e){var t=this;return(0,V.Z)(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.removeColumn("key.lock.name"),t.removeColumn("key.number"),t.removeColumn("key.safe.name"),n.next=5,F;case 5:a=n.sent,r={key_id:e},a.rental_getRentals(r).then((function(e){t.tableData=e.data}));case 8:case"end":return n.stop()}}),n)})))()},loadDataByUserId:function(e){var t=this;return(0,V.Z)(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.removeColumn("user.name"),n.next=3,F;case 3:a=n.sent,r={user_id:e},a.rental_getRentals(r).then((function(e){t.tableData=e.data}));case 6:case"end":return n.stop()}}),n)})))()},removeColumn:function(e){var t=this.headers.find((function(t){return t.value==e})),n=this.headers.indexOf(t);n>-1&&this.headers.splice(n,1)}},computed:{}}),bt=gt,_t=(0,m.Z)(bt,ht,kt,!1,null,"0235b12d",null),yt=_t.exports;x()(_t,{VIcon:$.Z});var xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("DataTable",{ref:"table",attrs:{headers:e.headers,items:e.tableData,"sort-by":"timestamp","sort-desc":!0},scopedSlots:e._u([{key:"header",fn:function(){return[n("h2",{staticClass:"ml-4"},[e._v("Logs")])]},proxy:!0},{key:"item.timestamp",fn:function(t){var n=t.item;return[e._v(" "+e._s(new Date(n.timestamp).toLocaleString())+" ")]}},{key:"item.creator.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/user/"+a.creator.id}},[e._v(e._s(a.creator.name))])]}},{key:"item.actions",fn:function(t){var a=t.item;return[n("div",{staticClass:"text-right"},e._l(["location","key","user","lock","safe","rental"],(function(t){return n("span",{key:t,staticStyle:{cursor:"pointer"}},[null!=a[t]?n("router-link",{staticClass:"mr-2 mt-1",staticStyle:{cursor:"pointer"},attrs:{to:"/"+t+"/"+a[t].id}},[n("v-chip",{staticStyle:{cursor:"pointer"},attrs:{color:"secondary",outlined:""}},[n("v-icon",{staticClass:"mr-1",attrs:{small:""}},[e._v(" "+e._s(e.obj_icons[t])+" ")]),a[t].name?n("span",[e._v(e._s(a[t].name))]):a[t].number?n("span",[e._v(e._s(a[t].number))]):a[t].begin?n("span",[e._v(e._s(new Date(a[t].begin).getDate().toLocaleString()))]):e._e()],1)],1):e._e()],1)})),0)]}}],null,!0)})],1)},Dt=[],wt={name:"DetailTableLogs",components:{DataTable:ae},data:function(){return{headers:[{text:"Datum",value:"timestamp",width:"10%"},{text:"Nutzer",value:"creator.name"},{text:"Nachricht",value:"message"},{text:"Links",value:"actions",width:"20%",sortable:!1,align:"right"}],tableData:null,obj_icons:{location:"mdi-map-marker",key:"mdi-key",user:"mdi-account",lock:"mdi-lock",safe:"mdi-safe-square",rental:"mdi-hand-coin"}}},methods:{loadData:function(e){var t=this;return(0,V.Z)(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,F;case 2:a=n.sent,a.log_getLogs(e).then((function(e){t.tableData=e.data}));case 4:case"end":return n.stop()}}),n)})))()}},computed:{}},St=wt,Zt=n(95424),$t=(0,m.Z)(St,xt,Dt,!1,null,null,null),Et=$t.exports;x()($t,{VChip:Zt.Z,VIcon:$.Z});var Tt={name:"DetailUserView",components:{DetailTableLogs:Et,DetailTableRentals:yt},data:function(){return{user:{name:"",login:"",email:"",note:""},userId:void 0}},mounted:function(){this.userId=this.$route.params.id,this.loadUser(),this.loadRentals(),this.loadLogs()},methods:{loadLogs:function(){this.$refs.logTable.loadData({user_id:this.userId})},loadUser:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.userId){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,F;case 4:n=t.sent,n.user_getUser(e.userId).then((function(t){e.user=t.data}));case 6:case"end":return t.stop()}}),t)})))()},loadRentals:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.rentalTable.loadDataByUserId(e.userId);case 1:case"end":return t.stop()}}),t)})))()},showFile:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/pdf",a=new Blob([e],{type:n}),r=window.URL.createObjectURL(a),o=document.createElement("a");o.href=r,o.download=t,o.click(),setTimeout((function(){window.URL.revokeObjectURL(r)}),100)},downloadProtocol:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,n.user_getUserProtocol({uuid:e.user.id},null,{responseType:"blob"}).then((function(t){var n=new Date,a=n.getFullYear()+"-"+String(n.getMonth()+1).padStart(2,"0")+"-"+String(n.getDate()).padStart(2,"0");e.showFile(t.data,"".concat(e.user.login,"-").concat(a,".pdf"))}));case 4:case"end":return t.stop()}}),t)})))()}}},Vt=Tt,Ct=n(83568),Rt=(0,m.Z)(Vt,vt,pt,!1,null,"6f59f52f",null),It=Rt.exports;x()(Rt,{VBtn:D.Z,VCard:w.Z,VDivider:ke.Z,VIcon:$.Z,VSimpleTable:Ct.Z});var Lt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{staticClass:"home pb-5 pt-1"},[n("div",{staticClass:"home pb-5"},[n("div",{staticClass:"mx-8"},[e.location.deleted?n("v-alert",{attrs:{color:"error"}},[e._v("Gelöscht.")]):e._e(),n("h2",{staticClass:"my-2"},[e._v("Ort Daten")]),n("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[n("tbody",[n("tr",[n("td",{staticStyle:{width:"20%"}},[n("span",[e._v("Name")])]),n("td",[n("b",[e._v(e._s(e.location.name))])])]),n("tr",[n("td",[e._v(" Adresse ")]),n("td",[e._v(e._s(e.location.address))])]),n("tr",[n("td",[e._v(" Anzahl Schlösser ")]),n("td",[e._v(e._s(e.location.amount_locks))])]),n("tr",[n("td",[e._v(" Anzahl Tresore ")]),n("td",[e._v(e._s(e.location.amount_safes))])]),n("tr",[n("td",[e._v(" Notiz ")]),n("td",[e._v(e._s(e.location.note))])])])]},proxy:!0}])}),n("v-divider"),n("div",{staticClass:"buttons"},[n("form-popup",{ref:"popup",attrs:{form:"edit-location-form",icon:"mdi-pencil",text:"Bearbeiten"},on:{mounted:e.mountedEvent,"save-form":function(t){e.loadLocation(),e.loadLogs()},"button-add-clicked":e.mountedEvent}}),n("v-dialog",{attrs:{width:"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("div",{staticClass:"tooltip",attrs:{title:e.tooltip}},[n("v-btn",e._g({staticClass:"mx-8 my-4",attrs:{disabled:e.deleteDisabled,color:"secondary"}},a),[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-delete")]),e._v(" Löschen ")],1)],1)]}}]),model:{value:e.deleteDialog,callback:function(t){e.deleteDialog=t},expression:"deleteDialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Ort "+e._s(e.location.name)+" wirklich löschen?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.deleteItem}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-delete")]),e._v(" Bestätigen ")],1)],1)],1)],1)],1),n("detail-table-locks",{ref:"lockTable",staticClass:"mt-10",on:{empty:function(t){e.locksEmpty=!0}}}),n("detail-table-safes",{ref:"safeTable",staticClass:"mt-10",on:{empty:function(t){e.safesEmpty=!0}}}),n("detail-table-logs",{ref:"logTable",staticClass:"mt-10"})],1)])])},At=[],Bt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("DataTable",{ref:"table",attrs:{headers:e.headers,items:e.tableData,"sort-by":"name"},scopedSlots:e._u([{key:"header",fn:function(){return[n("h2",{staticClass:"ml-4"},[e._v("Schlösser")])]},proxy:!0},{key:"item.available_keys",fn:function(t){var n=t.item;return[e._v(" "+e._s(n.amount_free_keys)+" / "+e._s(n.amount_keys)+" ")]}},{key:"item.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/lock/"+a.id}},[e._v(e._s(a.name))])]}}],null,!0)})},zt=[],Ft={name:"DetailTableLocks",components:{DataTable:ae},data:function(){return{headers:[{text:"Schloss",value:"name"},{text:"Besitzer",value:"owner"},{text:"Verfügbare Schlüssel",value:"available_keys"}],tableData:null}},methods:{loadDataByLocationId:function(e){var t=this;return(0,V.Z)(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,F;case 2:a=n.sent,r={location_id:e},a.lock_getLocks(r).then((function(e){t.tableData=e.data})).finally((function(){0==t.tableData.length&&t.$emit("empty")}));case 5:case"end":return n.stop()}}),n)})))()}}},Ut=Ft,Nt=(0,m.Z)(Ut,Bt,zt,!1,null,null,null),Kt=Nt.exports,Ot=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("DataTable",{ref:"table",attrs:{headers:e.headers,items:e.tableData,"sort-by":"name"},scopedSlots:e._u([{key:"header",fn:function(){return[n("h2",{staticClass:"ml-4"},[e._v("Tresore")])]},proxy:!0},{key:"item.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/safe/"+a.id}},[e._v(e._s(a.name))])]}}],null,!0)})},Pt=[],Mt={name:"DetailTableSafes",components:{DataTable:ae},data:function(){return{headers:[{text:"Tresor",value:"name"},{text:"Anzahl Schlüssel",value:"amount_keys"}],tableData:null}},methods:{loadDataByLocationId:function(e){var t=this;return(0,V.Z)(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,F;case 2:a=n.sent,r={location_id:e},a.safe_getSafes(r).then((function(e){t.tableData=e.data})).finally((function(){0==t.tableData.length&&t.$emit("empty")}));case 5:case"end":return n.stop()}}),n)})))()}}},jt=Mt,qt=(0,m.Z)(jt,Ot,Pt,!1,null,null,null),Gt=qt.exports,Jt={name:"LocationView",components:{DetailTableLogs:Et,DetailTableLocks:Kt,DetailTableSafes:Gt,FormPopup:T},data:function(){return{location:{},locationId:void 0,deleteDialog:!1,locksEmpty:!1,safesEmpty:!1}},mounted:function(){this.locationId=this.$route.params.id,this.loadLocation(),this.loadLocks(),this.loadSafes(),this.loadLogs()},methods:{loadLogs:function(){this.$refs.logTable.loadData({location_id:this.locationId})},loadLocation:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.locationId){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,F;case 4:n=t.sent,n.location_getLocation(e.locationId).then((function(t){e.location=t.data}));case 6:case"end":return t.stop()}}),t)})))()},loadLocks:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.lockTable.loadDataByLocationId(e.locationId);case 1:case"end":return t.stop()}}),t)})))()},loadSafes:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.safeTable.loadDataByLocationId(e.locationId);case 1:case"end":return t.stop()}}),t)})))()},mountedEvent:function(){this.$refs.popup.$refs.form&&this.$refs.popup.$refs.form.fillForm(this.location)},deleteItem:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,a={uuid:e.location.id},n.location_deleteLocation(a).then((function(){e.$router.push("/location")}));case 5:case"end":return t.stop()}}),t)})))()}},computed:{deleteDisabled:function(){return!this.safesEmpty},tooltip:function(){return this.deleteDisabled?"Ort kann nur gelöscht werden, wenn ihm keine Tresore zugewiesen sind":""}}},Wt=Jt,Ht=n(51234),Yt=(0,m.Z)(Wt,Lt,At,!1,null,"c401078a",null),Qt=Yt.exports;x()(Yt,{VAlert:Ht.Z,VBtn:D.Z,VCard:w.Z,VCardActions:S.h7,VCardTitle:S.EB,VDialog:Z.Z,VDivider:ke.Z,VIcon:$.Z,VSimpleTable:Ct.Z,VSpacer:ee.Z});var Xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{staticClass:"home pb-5 pt-1"},[n("div",{staticClass:"home pb-5"},[n("div",{staticClass:"mx-8"},[e.safe.deleted?n("v-alert",{attrs:{color:"error"}},[e._v("Gelöscht.")]):e._e(),n("h2",{staticClass:"my-2"},[e._v("Tresor Daten")]),n("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[n("tbody",[n("tr",[n("td",{staticStyle:{width:"20%"}},[e._v("Name")]),n("td",[n("b",[e._v(e._s(e.safe.name))])])]),n("tr",[n("td",[e._v("Ort")]),n("td",[n("router-link",{attrs:{to:"/location/"+e.safe.location.id}},[e._v(e._s(e.safe.location.name))])],1)]),n("tr",[n("td",[e._v("Anzahl Schlüssel")]),n("td",[e._v(e._s(e.safe.amount_keys))])]),n("tr",[n("td",[e._v("Notiz")]),n("td",[e._v(e._s(e.safe.note))])])])]},proxy:!0}])}),n("v-divider"),n("div",{staticClass:"buttons"},[n("form-popup",{ref:"popup_add",attrs:{form:"edit-key-form",icon:"mdi-plus",text:"Schlüssel hinzufügen"},on:{mounted:e.addMountedEvent,"save-form":function(t){return e.keyAdded()},"button-add-clicked":e.addMountedEvent}}),n("form-popup",{ref:"popup",attrs:{form:"edit-safe-form",icon:"mdi-pencil",text:"Bearbeiten"},on:{mounted:e.mountedEvent,"save-form":function(t){e.loadSafe(),e.loadLogs()},"button-add-clicked":e.mountedEvent}}),n("v-dialog",{attrs:{width:"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("div",{staticClass:"tooltip",attrs:{title:e.tooltip}},[n("v-btn",e._g({staticClass:"mx-8 my-4",attrs:{disabled:e.deleteDisabled,color:"secondary"}},a),[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-delete")]),e._v(" Löschen ")],1)],1)]}}]),model:{value:e.deleteDialog,callback:function(t){e.deleteDialog=t},expression:"deleteDialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Tresor "+e._s(e.safe.name)+" wirklich löschen?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.deleteItem}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-delete")]),e._v(" Bestätigen ")],1)],1)],1)],1)],1),n("detail-table-keys",{ref:"keyTable",staticClass:"mt-10",on:{empty:function(t){e.keysEmpty=!0},rented:function(t){return e.$refs.keyTable.loadDataBySafeId(e.safe.id)}}}),n("detail-table-logs",{ref:"logTable",staticClass:"mt-10"})],1)])])},en=[],tn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("DataTable",{ref:"table",attrs:{headers:e.headers,"item-class":e.row_classes,items:e.tableData,"sort-by":"number"},scopedSlots:e._u([{key:"header",fn:function(){return[n("h2",{staticClass:"ml-4"},[e._v("Schlüssel")])]},proxy:!0},{key:"item.number",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/key/"+a.id}},[e._v(e._s(a.number))])]}},{key:"item.safe.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/safe/"+a.safe.id}},[e._v(e._s(a.safe.name))])]}},{key:"item.lock.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/lock/"+a.lock.id}},[e._v(e._s(a.lock.name))])]}},{key:"item.rental",fn:function(t){var n=t.item;return[e._v(" "+e._s(e.getRentalStatus(n))+" ")]}},{key:"item.actions",fn:function(t){var a=t.item;return[n("div",{staticClass:"text-right"},[e.rentable(a)||e.rentedByUser(a)?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[n("v-icon",e._g({staticClass:"ml-2",attrs:{color:e.getKeyColor(a),small:""},on:{click:function(t){return e.openRentPrompt(a)}}},r),[e._v(" mdi-hand-coin ")])]}}],null,!0)},[n("span",[e._v(e._s(e.getTooltip(a)))])]):e._e()],1)]}}],null,!0)}),n("v-dialog",{attrs:{width:"500px"},model:{value:e.returnDialog,callback:function(t){e.returnDialog=t},expression:"returnDialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Schlüssel "+e._s(e.keyInDialogNumber)+" wirklich zurückgeben?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.returnItem}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-content-save-outline")]),e._v(" Bestätigen ")],1)],1)],1)],1),n("v-dialog",{attrs:{width:"500px"},model:{value:e.rentDialog,callback:function(t){e.rentDialog=t},expression:"rentDialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Schlüssel "+e._s(e.keyInDialogNumber)+" wirklich ausleihen?")]),n("v-card-text",[n("v-form",{ref:"form"},[n("v-autocomplete",{attrs:{"item-text":function(e){return e.name},items:e.users,rules:e.userRules,label:"Vergeben an","prepend-icon":"mdi-account","return-object":""},model:{value:e.pickedUser,callback:function(t){e.pickedUser=t},expression:"pickedUser"}}),n("v-text-field",{attrs:{label:"Dokument","prepend-icon":"mdi-file-document"},model:{value:e.grantingDocument,callback:function(t){e.grantingDocument=t},expression:"grantingDocument"}}),n("v-textarea",{attrs:{label:"Notiz","prepend-icon":"mdi-note-text-outline",rows:"1"},model:{value:e.note,callback:function(t){e.note=t},expression:"note"}}),n("v-checkbox",{attrs:{label:"Startdatum bearbeiten"},model:{value:e.editStartDate,callback:function(t){e.editStartDate=t},expression:"editStartDate"}}),n("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({staticStyle:{"margin-top":"-10px"},attrs:{disabled:!e.editStartDate,label:"Startdatum","prepend-icon":"mdi-calendar",readonly:""},model:{value:e.dateStart,callback:function(t){e.dateStart=t},expression:"dateStart"}},"v-text-field",r,!1),a))]}}]),model:{value:e.menuStartDate,callback:function(t){e.menuStartDate=t},expression:"menuStartDate"}},[n("v-date-picker",{on:{input:function(t){e.menuStartDate=!1}},model:{value:e.dateStart,callback:function(t){e.dateStart=t},expression:"dateStart"}})],1),n("v-checkbox",{attrs:{label:"Enddatum bearbeiten"},model:{value:e.editEndDate,callback:function(t){e.editEndDate=t},expression:"editEndDate"}}),n("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({staticStyle:{"margin-top":"-10px"},attrs:{disabled:!e.editEndDate,label:"Enddatum","prepend-icon":"mdi-calendar",readonly:""},model:{value:e.dateEnd,callback:function(t){e.dateEnd=t},expression:"dateEnd"}},"v-text-field",r,!1),a))]}}]),model:{value:e.menuEndDate,callback:function(t){e.menuEndDate=t},expression:"menuEndDate"}},[n("v-date-picker",{on:{input:function(t){e.menuEndDate=!1}},model:{value:e.dateEnd,callback:function(t){e.dateEnd=t},expression:"dateEnd"}})],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.rentKey}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-content-save-outline")]),e._v(" Speichern ")],1)],1)],1)],1)],1)},nn=[],an={name:"DetailTableKeys",components:{DataTable:ae},data:function(){return{keyInDialog:void 0,rentDialog:!1,returnDialog:!1,grantingDocument:"",note:"",menuStartDate:!1,editStartDate:!1,dateStart:void 0,menuEndDate:!1,editEndDate:!1,dateEnd:void 0,headers:[{text:"Schlüsselnummer",value:"number"},{text:"Tresor",value:"safe.name"},{text:"Schloss",value:"lock.name"},{text:"Ausleihe",value:"rental"},{text:"Aktionen",value:"actions",width:"200px",sortable:!1,align:"right"}],tableData:null,usersLoaded:!1,users:[],pickedUser:void 0,userRules:[function(e){return!!e||"Bitte Nutzer auswählen"}]}},methods:{loadDataBySafeId:function(e){var t=this;return(0,V.Z)(regeneratorRuntime.mark((function n(){var a,r,o,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=t.headers.find((function(e){return"safe.name"==e.value})),r=t.headers.indexOf(a),r>-1&&t.headers.splice(r,1),n.next=5,F;case 5:o=n.sent,i={safe_id:e},o.key_getKeys(i).then((function(e){t.tableData=e.data})).finally((function(){0==t.tableData.length&&t.$emit("empty")}));case 8:case"end":return n.stop()}}),n)})))()},loadDataByLockId:function(e){var t=this;return(0,V.Z)(regeneratorRuntime.mark((function n(){var a,r,o,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=t.headers.find((function(e){return"lock.name"==e.value})),r=t.headers.indexOf(a),r>-1&&t.headers.splice(r,1),n.next=5,F;case 5:o=n.sent,i={lock_id:e},o.key_getKeys(i).then((function(e){t.tableData=e.data})).finally((function(){0==t.tableData.length&&t.$emit("empty")}));case 8:case"end":return n.stop()}}),n)})))()},getRentalStatus:function(e){return this.rentedByUser(e)?"Ausgeliehen (von dir)":e.active_rental?"Ausgeliehen":e.rentable?"Ausleihbar":"Nicht ausleihbar"},row_classes:function(e){return null==e.active_rental&&e.rentable?"green-cell":e.rentable?"red-cell":"grey-cell"},getKeyColor:function(e){return"initial"},openRentPrompt:function(e){this.keyInDialog=e,this.editStartDate=!1,this.editEndDate=!1,this.rentedByUser(e)?this.returnDialog=!0:(this.loadUsers(),this.rentDialog=!0,this.grantingDocument="",this.note="",this.dateStart="",this.dateEnd="",this.pickedUser=void 0)},getTooltip:function(e){return this.rentedByUser(e)?"Schlüssel zurückgeben":"Schlüssel ausleihen"},rentedByUser:function(e){if(!e.active_rental)return!1;var t=K.getUser();return t.id==e.active_rental.user_id},loadUsers:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.usersLoaded){t.next=2;break}return t.abrupt("return");case 2:return e.usersLoaded=!0,t.next=5,F;case 5:n=t.sent,n.user_getUsers().then((function(t){e.users=t.data}));case 7:case"end":return t.stop()}}),t)})))()},returnItem:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,a={uuid:e.keyInDialog.active_rental.id},n.rental_endRental(a).then((function(){e.returnDialog=!1,e.$emit("rented")}));case 5:case"end":return t.stop()}}),t)})))()},dateToDatetime:function(e){return e+"T12:37"},rentKey:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()){t.next=8;break}return t.next=3,F;case 3:n=t.sent,a={key_id:e.keyInDialog.id,user_id:e.pickedUser.id,allowed_by:e.grantingDocument,note:e.note},e.editStartDate&&e.dateStart&&(a.begin=e.dateToDatetime(e.dateStart)),e.editEndDate&&e.dateEnd&&(a.end=e.dateToDatetime(e.dateEnd)),n.rental_createRental(null,a).then((function(){e.rentDialog=!1,e.$emit("rented"),e.$refs.form.resetValidation(),e.pickedUser=void 0}));case 8:case"end":return t.stop()}}),t)})))()},rentable:function(e){return"Ausleihbar"===this.getRentalStatus(e)}},computed:{keyInDialogNumber:function(){return this.keyInDialog?this.keyInDialog.number:""}}},rn=an,on=(0,m.Z)(rn,tn,nn,!1,null,"ddad19ba",null),sn=on.exports;x()(on,{VAutocomplete:ie.Z,VBtn:D.Z,VCard:w.Z,VCardActions:S.h7,VCardText:S.ZB,VCardTitle:S.EB,VCheckbox:se.Z,VDatePicker:le.Z,VDialog:Z.Z,VForm:ce.Z,VIcon:$.Z,VMenu:ue.Z,VSpacer:ee.Z,VTextField:te.Z,VTextarea:de.Z,VTooltip:me.Z});var ln={name:"DetailSafeView",components:{DetailTableLogs:Et,DetailTableKeys:sn,FormPopup:T},data:function(){return{safe:{location:{}},safeId:void 0,deleteDialog:!1,keysEmpty:!1}},mounted:function(){this.safeId=this.$route.params.id,this.loadSafe(),this.loadKeys(),this.loadLogs()},methods:{loadLogs:function(){this.$refs.logTable.loadData({safe_id:this.safeId})},loadSafe:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.safeId){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,F;case 4:n=t.sent,n.safe_getSafe(e.safeId).then((function(t){e.safe=t.data}));case 6:case"end":return t.stop()}}),t)})))()},loadKeys:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.keyTable.loadDataBySafeId(e.safeId);case 1:case"end":return t.stop()}}),t)})))()},mountedEvent:function(){this.$refs.popup.$refs.form&&this.$refs.popup.$refs.form.fillForm(this.safe)},addMountedEvent:function(){var e={safe:this.safe};this.$refs.popup_add.$refs.form&&this.$refs.popup_add.$refs.form.fillForm(e)},keyAdded:function(){var e=this.$refs.popup_add.$refs.form.keyId;this.$router.push("/key/"+e)},deleteItem:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,a={uuid:e.safe.id},n.safe_deleteSafe(a).then((function(){e.$router.push("/safe")}));case 5:case"end":return t.stop()}}),t)})))()}},computed:{deleteDisabled:function(){return!this.keysEmpty},tooltip:function(){return this.deleteDisabled?"Tresor kann nur gelöscht werden, wenn ihm keine Schlüssel zugewiesen sind":""}}},cn=ln,un=(0,m.Z)(cn,Xt,en,!1,null,"1c86f560",null),dn=un.exports;x()(un,{VAlert:Ht.Z,VBtn:D.Z,VCard:w.Z,VCardActions:S.h7,VCardTitle:S.EB,VDialog:Z.Z,VDivider:ke.Z,VIcon:$.Z,VSimpleTable:Ct.Z,VSpacer:ee.Z});var mn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{staticClass:"home pb-5 pt-1"},[n("div",{staticClass:"home pb-5"},[n("div",{staticClass:"mx-8"},[e.lock.deleted?n("v-alert",{attrs:{color:"error"}},[e._v("Gelöscht.")]):e._e(),n("h2",{staticClass:"my-2"},[e._v("Schloss Daten")]),n("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[n("tbody",[n("tr",[n("td",{staticStyle:{width:"20%"}},[e._v("Name")]),n("td",[n("b",[e._v(e._s(e.lock.name))])])]),n("tr",[n("td",[e._v("Ort")]),n("td",[n("router-link",{attrs:{to:"/location/"+e.lock.location.id}},[e._v(e._s(e.lock.location.name))])],1)]),n("tr",[n("td",[e._v("Besitzer")]),n("td",[e._v(e._s(e.lock.owner))])]),n("tr",[n("td",[e._v("Anzahl Schlüssel")]),n("td",[e._v(e._s(e.lock.amount_keys)+" ("+e._s(e.lock.amount_free_keys)+" verfügbar)")])]),n("tr",[n("td",[e._v("Notiz")]),n("td",[e._v(e._s(e.lock.note))])])])]},proxy:!0}])}),n("v-divider"),n("div",{staticClass:"buttons"},[n("form-popup",{ref:"popup_add",attrs:{form:"edit-key-form",icon:"mdi-plus",text:"Schlüssel hinzufügen"},on:{mounted:e.addMountedEvent,"save-form":function(t){return e.keyAdded()},"button-add-clicked":e.addMountedEvent}}),n("form-popup",{ref:"popup",attrs:{form:"edit-lock-form",icon:"mdi-pencil",text:"Bearbeiten"},on:{mounted:e.mountedEvent,"save-form":function(t){e.loadLock(),e.loadLogs()},"button-add-clicked":e.mountedEvent}}),n("v-dialog",{attrs:{width:"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({staticClass:"mx-8 my-4",attrs:{color:"secondary"}},a),[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-delete")]),e._v(" Löschen ")],1)]}}]),model:{value:e.deleteDialog,callback:function(t){e.deleteDialog=t},expression:"deleteDialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Schloss "+e._s(e.lock.name)+" wirklich löschen?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.deleteItem}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-delete")]),e._v(" Bestätigen ")],1)],1)],1)],1)],1),n("detail-table-keys",{ref:"keyTable",staticClass:"mt-10",on:{empty:function(t){e.keysEmpty=!0},rented:function(t){return e.$refs.keyTable.loadDataByLockId(e.lock.id)}}}),n("detail-table-logs",{ref:"logTable",staticClass:"mt-10"})],1)])])},fn=[],vn={name:"DetailLockView",components:{DetailTableLogs:Et,DetailTableKeys:sn,FormPopup:T},data:function(){return{lock:{location:{}},lockId:void 0,deleteDialog:!1,keysEmpty:!1}},mounted:function(){this.lockId=this.$route.params.id,this.loadLock(),this.loadKeys(),this.loadLogs()},methods:{loadLogs:function(){this.$refs.logTable.loadData({lock_id:this.lockId})},loadLock:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.lockId){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,F;case 4:n=t.sent,n.lock_getLock(e.lockId).then((function(t){e.lock=t.data}));case 6:case"end":return t.stop()}}),t)})))()},loadKeys:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.keyTable.loadDataByLockId(e.lockId);case 1:case"end":return t.stop()}}),t)})))()},mountedEvent:function(){this.$refs.popup.$refs.form&&this.$refs.popup.$refs.form.fillForm(this.lock)},addMountedEvent:function(){var e={lock:this.lock};this.$refs.popup_add.$refs.form&&this.$refs.popup_add.$refs.form.fillForm(e)},keyAdded:function(){var e=this.$refs.popup_add.$refs.form.keyId;this.$router.push("/key/"+e)},deleteItem:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,a={uuid:e.lock.id},n.lock_deleteLock(a).then((function(){e.$router.push("/lock")}));case 5:case"end":return t.stop()}}),t)})))()}},computed:{deleteDisabled:function(){return!this.keysEmpty},tooltip:function(){return this.deleteDisabled?"Schloss kann nur gelöscht werden, wenn ihm keine Schlüssel zugewiesen sind":""}}},pn=vn,hn=(0,m.Z)(pn,mn,fn,!1,null,"59dd2de2",null),kn=hn.exports;x()(hn,{VAlert:Ht.Z,VBtn:D.Z,VCard:w.Z,VCardActions:S.h7,VCardTitle:S.EB,VDialog:Z.Z,VDivider:ke.Z,VIcon:$.Z,VSimpleTable:Ct.Z,VSpacer:ee.Z});var gn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{staticClass:"home pb-5 pt-1"},[n("div",{staticClass:"mx-8"},[e.key.deleted?n("v-alert",{attrs:{color:"error"}},[e._v("Gelöscht.")]):e._e(),n("h2",{staticClass:"my-2"},[e._v("Schlüssel Daten")]),n("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[n("tbody",[n("tr",[n("td",{staticStyle:{width:"20%"}},[e._v("Schlüsselnummer")]),n("td",[n("b",[e._v(e._s(e.key.number))])])]),n("tr",[n("td",[e._v("Schloss")]),n("td",[n("router-link",{attrs:{to:"/lock/"+e.key.lock.id}},[e._v(e._s(e.key.lock.name))])],1)]),n("tr",[n("td",[e._v("Tresor")]),n("td",[n("router-link",{attrs:{to:"/safe/"+e.key.safe.id}},[e._v(e._s(e.key.safe.name))])],1)]),n("tr",[n("td",[e._v("Ausleihe")]),n("td",{class:e.rentalColor},[e._v(e._s(e.rentalStatus))])]),n("tr",[n("td",[e._v("Notiz")]),n("td",[e._v(e._s(e.key.note))])])])]},proxy:!0}])}),n("v-divider"),n("div",{staticClass:"buttons"},[e.rentedByUser?n("v-dialog",{attrs:{width:"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({staticClass:"mx-8 my-4",attrs:{color:"secondary"}},a),[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-key")]),e._v(" Zurückgeben ")],1)]}}],null,!1,989103630),model:{value:e.returnDialog,callback:function(t){e.returnDialog=t},expression:"returnDialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Schlüssel "+e._s(e.key.name)+" wirklich zurückgeben?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.returnItem}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-content-save-outline")]),e._v(" Speichern ")],1)],1)],1)],1):e._e(),e.rentalEnabled?n("form-popup",{ref:"rentalPopup",attrs:{form:"rent-key-form",icon:"mdi-key",text:"Ausleihen"},on:{mounted:e.rentalFormMountedEvent,"save-form":function(t){e.loadKey(),e.loadRentals(),e.loadLogs()}}}):e._e(),n("form-popup",{ref:"popup",attrs:{form:"edit-key-form",icon:"mdi-pencil",text:"Bearbeiten"},on:{mounted:e.mountedEvent,"save-form":function(t){e.loadKey(),e.loadLogs()},"button-add-clicked":e.mountedEvent}}),n("v-dialog",{attrs:{width:"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({staticClass:"mx-8 my-4",attrs:{color:"secondary"}},a),[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-delete")]),e._v(" Löschen ")],1)]}}]),model:{value:e.deleteDialog,callback:function(t){e.deleteDialog=t},expression:"deleteDialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Schlüssel "+e._s(e.key.name)+" wirklich löschen?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.deleteItem}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-delete")]),e._v(" Bestätigen ")],1)],1)],1)],1)],1),n("detail-table-rentals",{ref:"rentalTable",staticClass:"mt-10"}),n("detail-table-logs",{ref:"logTable",staticClass:"mt-10"})],1)])},bn=[],_n={name:"DetailKeyView",components:{DetailTableLogs:Et,DetailTableRentals:yt,FormPopup:T},data:function(){return{key:{location:{},safe:{},lock:{}},keyId:void 0,deleteDialog:!1,rentDialog:!1,returnDialog:!1}},mounted:function(){this.keyId=this.$route.params.id,this.loadKey(),this.loadRentals(),this.loadLogs()},methods:{loadLogs:function(){this.$refs.logTable.loadData({key_id:this.keyId})},loadKey:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.keyId){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,F;case 4:n=t.sent,n.key_getKey(e.keyId).then((function(t){e.key=t.data}));case 6:case"end":return t.stop()}}),t)})))()},loadRentals:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.rentalTable.loadDataByKeyId(e.keyId);case 1:case"end":return t.stop()}}),t)})))()},rentalFormMountedEvent:function(){this.$refs.rentalPopup.$refs.form&&this.$refs.rentalPopup.$refs.form.setKeyId(this.key.id)},mountedEvent:function(){this.$refs.popup.$refs.form&&this.$refs.popup.$refs.form.fillForm(this.key)},deleteItem:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,a={uuid:e.key.id},n.key_deleteKey(a).then((function(){e.$router.push("/key")}));case 5:case"end":return t.stop()}}),t)})))()},returnItem:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,a={uuid:e.key.active_rental.id},n.rental_endRental(a).then((function(){e.returnDialog=!1,e.loadKey(),e.loadRentals()}));case 5:case"end":return t.stop()}}),t)})))()}},computed:{rentalStatus:function(){return this.key?this.rentedByUser?"Ausgeliehen (von dir)":this.key.active_rental?"Ausgeliehen":this.key.rentable?"Ausleihbar":"Nicht ausleihbar":""},rentalColor:function(){return null==this.key.active_rental&&this.key.rentable?"green-cell":"red-cell"},deleteDisabled:function(){return void 0!=this.key.active_rental},rentalEnabled:function(){return"Ausleihbar"==this.rentalStatus},tooltip:function(){return this.deleteDisabled?"Schlüssel kann nur gelöscht werden, wenn er momentan nicht verliehen ist":""},rentedByUser:function(){if(!this.key.active_rental)return!1;var e=K.getUser();return e.id==this.key.active_rental.user_id}}},yn=_n,xn=(0,m.Z)(yn,gn,bn,!1,null,"20a9664b",null),Dn=xn.exports;x()(xn,{VAlert:Ht.Z,VBtn:D.Z,VCard:w.Z,VCardActions:S.h7,VCardTitle:S.EB,VDialog:Z.Z,VDivider:ke.Z,VIcon:$.Z,VSimpleTable:Ct.Z,VSpacer:ee.Z});var wn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"text-center"},[e._m(0),n("div",[e.loggedOut?n("span",{staticClass:"subtitle-1"},[e._v(" Bitte melde dich an, um Keywi zu nutzen. ")]):e._e()])])},Sn=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("Willkommen bei Keywi, der digitalen Schlüsselverwaltung.")])])}],Zn={name:"StartView",computed:{loggedOut:function(){return!K.isLoggedIn()}}},$n=Zn,En=(0,m.Z)($n,wn,Sn,!1,null,null,null),Tn=En.exports,Vn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{staticClass:"home pb-5 pt-1"},[n("div",{staticClass:"mx-8"},[e.rental.deleted?n("v-alert",{attrs:{color:"error"}},[e._v("Gelöscht.")]):e._e(),n("h2",{staticClass:"my-2"},[e._v("Ausleihe Daten")]),n("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[n("tbody",[n("tr",[n("td",{staticStyle:{width:"20%"}},[e._v("Schlüssel")]),n("td",[n("router-link",{attrs:{to:"/key/"+e.rental.key.id}},[e._v(e._s(e.rental.key.number))])],1)]),n("tr",[n("td",[e._v("Vergeben an")]),n("td",[n("router-link",{attrs:{to:"/user/"+e.rental.user.id}},[e._v(e._s(e.rental.user.name))])],1)]),n("tr",[n("td",[e._v("Ausgegeben von")]),n("td",[n("router-link",{attrs:{to:"/user/"+e.rental.issuing_user.id}},[e._v(e._s(e.rental.issuing_user.name))])],1)]),n("tr",[n("td",[e._v("Dokument")]),n("td",[e._v(e._s(e.rental.allowed_by))])]),n("tr",[n("td",[e._v("Start")]),n("td",[e._v(e._s(new Date(e.rental.begin).toLocaleString("de")))])]),n("tr",[n("td",[e._v("Ende")]),n("td",[e.rental.end?n("span",[e._v(e._s(new Date(e.rental.end).toLocaleString("de")))]):e._e()])]),n("tr",[n("td",[e._v("Aktiv")]),null!=e.rental.active?n("td",{staticClass:"font-weight-bold"},[e.rental.active?n("span",{staticClass:"green--text"},[e._v(" Ja ")]):n("span",{staticClass:"red--text"},[e._v(" Nein ")])]):e._e()]),n("tr",[n("td",[e._v("Notiz")]),n("td",[e._v(e._s(e.rental.note))])])])]},proxy:!0}])}),n("v-divider"),n("div",{staticClass:"buttons"},[n("v-dialog",{attrs:{width:"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({staticClass:"mx-8 my-4",attrs:{color:"secondary"}},a),[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-delete")]),e._v(" Löschen ")],1)]}}]),model:{value:e.deleteDialog,callback:function(t){e.deleteDialog=t},expression:"deleteDialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Ausleihe wirklich löschen?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.deleteItem}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-delete")]),e._v(" Bestätigen ")],1)],1)],1)],1),n("form-popup",{ref:"rentalEditPopup",attrs:{form:"edit-rental-form",icon:"mdi-pencil",text:"Bearbeiten"},on:{mounted:function(t){return e.rentalEditFormMountedEvent()},"save-form":function(t){e.loadRental(),e.loadLogs()},"button-add-clicked":function(t){return e.rentalEditFormMountedEvent()}}}),e.rental.active?n("v-dialog",{attrs:{width:"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({staticClass:"mx-8 my-4",attrs:{color:"secondary"}},a),[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-arrow-u-left-bottom")]),e._v(" Schlüssel Zurückgeben ")],1)]}}],null,!1,4233237325),model:{value:e.returnDialog,callback:function(t){e.returnDialog=t},expression:"returnDialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Schlüssel wirklich zurückgeben?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.returnItem}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-check")]),e._v(" Speichern ")],1)],1)],1)],1):e._e()],1),n("detail-table-logs",{ref:"logTable",staticClass:"mt-10"})],1)])},Cn=[],Rn={name:"DetailRentalView",components:{DetailTableLogs:Et,FormPopup:T},data:function(){return{rental:{key:{},user:{},issuing_user:{}},rentalId:void 0,returnDialog:!1,deleteDialog:!1}},mounted:function(){this.rentalId=this.$route.params.id,this.loadRental(),this.loadLogs()},methods:{loadLogs:function(){this.$refs.logTable.loadData({rental_id:this.rentalId})},loadRental:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.rentalId){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,F;case 4:n=t.sent,n.rental_getRental(e.rentalId).then((function(t){e.rental=t.data}));case 6:case"end":return t.stop()}}),t)})))()},rentalEditFormMountedEvent:function(){this.$refs.rentalEditPopup.$refs.form&&this.$refs.rentalEditPopup.$refs.form.fillForm(this.rental)},returnItem:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,a={uuid:e.rental.id},n.rental_endRental(a).then((function(){e.returnDialog=!1,e.loadRental()}));case 5:case"end":return t.stop()}}),t)})))()},deleteItem:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,a={uuid:e.rental.id},n.rental_deleteRental(a).then((function(){e.$router.push("/rental")}));case 5:case"end":return t.stop()}}),t)})))()}},computed:{rentedByUser:function(){if(!this.rental.active)return!1;var e=K.getUser();return e.id===this.rental.user.id}}},In=Rn,Ln=(0,m.Z)(In,Vn,Cn,!1,null,"4437ed1b",null),An=Ln.exports;x()(Ln,{VAlert:Ht.Z,VBtn:D.Z,VCard:w.Z,VCardActions:S.h7,VCardTitle:S.EB,VDialog:Z.Z,VDivider:ke.Z,VIcon:$.Z,VSimpleTable:Ct.Z,VSpacer:ee.Z});var Bn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home pb-5"},[n("rental-table",{ref:"rentalTable",staticClass:"mx-7 mt-7",on:{editItem:e.editRental}}),n("form-popup",{ref:"popup",attrs:{text:"Ausleihe bearbeiten",form:"edit-rental-form","hide-btn":""},on:{"save-form":function(t){return e.$refs.rentalTable.loadData()},mounted:e.mountedEvent}})],1)},zn=[],Fn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("DataTable",{ref:"table",attrs:{headers:e.headers,items:e.tableData,"sort-by":"begin","sort-desc":!0},scopedSlots:e._u([{key:"header",fn:function(){return[n("h2",{staticClass:"ml-4"},[e._v("Ausleihen")])]},proxy:!0},{key:"item.link",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/rental/"+a.id}},[n("v-icon",{attrs:{small:""}},[e._v(" mdi-open-in-new ")])],1)]}},{key:"item.begin",fn:function(t){var n=t.item;return[e._v(" "+e._s(new Date(n.begin).toLocaleString("de"))+" ")]}},{key:"item.end",fn:function(t){var a=t.item;return[null!=a.end?n("span",[e._v(" "+e._s(new Date(a.end).toLocaleString("de"))+" ")]):n("span",[e._v(" - ")])]}},{key:"item.key.lock.location",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/location/"+a.key.lock.location.id}},[e._v(e._s(a.key.lock.location.name))])]}},{key:"item.key.lock",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/lock/"+a.key.lock.id}},[e._v(e._s(a.key.lock.name))])]}},{key:"item.key",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/key/"+a.key.id}},[e._v(e._s(a.key.number))])]}},{key:"item.user.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/user/"+a.user.id}},[e._v(e._s(a.user.name))])]}},{key:"item.issuing_user.name",fn:function(t){var a=t.item;return[n("router-link",{attrs:{to:"/user/"+a.issuing_user.id}},[e._v(e._s(a.issuing_user.name))])]}},{key:"item.actions",fn:function(t){var a=t.item;return[n("div",{staticClass:"text-right"},[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(a)}}},[e._v(" mdi-pencil ")]),a.active?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[n("v-icon",e._g({staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.openReturnPrompt(a)}}},r),[e._v(" mdi-arrow-u-left-bottom ")])]}}],null,!0)},[n("span",[e._v("Schlüssel zurückgeben")])]):e._e()],1)]}}],null,!0)}),n("v-dialog",{attrs:{width:"500px"},model:{value:e.returnDialog,callback:function(t){e.returnDialog=t},expression:"returnDialog"}},[n("v-card",{staticClass:"pb-1"},[n("v-card-title",[e._v("Schlüssel "+e._s(e.rentalInDialog.key.number)+" wirklich zurückgeben?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"secondary"},on:{click:e.returnItem}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-check")]),e._v(" Bestätigen ")],1)],1)],1)],1)],1)},Un=[],Nn={name:"RentalTable",components:{DataTable:ae},data:function(){return{dialog:!1,headers:[{width:"5%",text:"Link",value:"link"},{text:"Ort",value:"key.lock.location"},{text:"Schloss",value:"key.lock"},{text:"Schlüsselnummer",value:"key"},{text:"Ausgeliehen von",value:"user.name"},{text:"Ausgegeben von",value:"issuing_user.name"},{text:"Beginn",value:"begin"},{text:"Ende",value:"end"},{text:"Aktionen",value:"actions",width:"200px",sortable:!1,align:"right"}],tableData:null,rentalInDialog:{key:{}},returnDialog:!1}},mounted:function(){this.loadData()},methods:{loadData:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.$route.params.id,t.next=3,F;case 3:a=t.sent,n?a.rental_getRental(n).then((function(t){e.tableData=[t.data]})):a.rental_getRentals().then((function(t){e.tableData=t.data}));case 5:case"end":return t.stop()}}),t)})))()},editItem:function(e){this.$emit("editItem",e)},rentedByUser:function(e){if(!e.active)return!1;var t=K.getUser();return t.id==e.user.id},openReturnPrompt:function(e){this.rentalInDialog=e,this.returnDialog=!0},returnItem:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,a={uuid:e.rentalInDialog.id},n.rental_endRental(a).then((function(){e.returnDialog=!1,e.loadData()}));case 5:case"end":return t.stop()}}),t)})))()}}},Kn=Nn,On=(0,m.Z)(Kn,Fn,Un,!1,null,null,null),Pn=On.exports;x()(On,{VBtn:D.Z,VCard:w.Z,VCardActions:S.h7,VCardTitle:S.EB,VDialog:Z.Z,VIcon:$.Z,VSpacer:ee.Z,VTooltip:me.Z});var Mn=a.Z.extend({name:"AllRentalsView",components:{FormPopup:T,RentalTable:Pn},data:function(){return{editedRental:void 0}},methods:{editRental:function(e){this.editedRental=e,this.$refs.popup.openDialog(),this.$refs.popup.$refs.form&&this.$refs.popup.$refs.form.fillForm(this.editedRental)},mountedEvent:function(){this.$refs.popup.$refs.form.fillForm(this.editedRental)}}}),jn=Mn,qn=(0,m.Z)(jn,Bn,zn,!1,null,"2f321788",null),Gn=qn.exports,Jn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home pb-5"},[n("detail-table-logs",{ref:"logTable",staticClass:"mx-7 mt-7"})],1)},Wn=[],Hn=a.Z.extend({name:"AllLogsView",components:{DetailTableLogs:Et},data:function(){return{}},mounted:function(){this.$refs.logTable.loadData({})}}),Yn=Hn,Qn=(0,m.Z)(Yn,Jn,Wn,!1,null,"c3224a78",null),Xn=Qn.exports;a.Z.use(O.Z);var ea=[{path:"/",name:"start",component:Tn,meta:{title:"Start"}},{path:"/key",name:"keyAll",component:be,meta:{title:"Alle Schlüssel"}},{path:"/key/:id",name:"key",component:Dn,meta:{title:"Schlüssel Details"}},{path:"/safe/",name:"safeAll",component:Ce,meta:{title:"Alle Tresore"}},{path:"/safe/:id",name:"safe",component:dn,meta:{title:"Tresor Details"}},{path:"/lock",name:"lockAll",component:Pe,meta:{title:"Alle Schlösser"}},{path:"/lock/:id",name:"lock",component:kn,meta:{title:"Schloss Details"}},{path:"/location",name:"locationAll",component:tt,meta:{title:"Alle Orte"}},{path:"/location/:id",name:"location",component:Qt,meta:{title:"Ort Details"}},{path:"/user",name:"users",component:ft,meta:{title:"Alle Benutzer"}},{path:"/user/:id",name:"user",component:It,meta:{title:"Benutzer Details"}},{path:"/rental",name:"rentals",component:Gn,meta:{title:"Alle Ausleihen"}},{path:"/rental/:id",name:"rental",component:An,meta:{title:"Ausleihe Details"}},{path:"/log",name:"logs",component:Xn,meta:{title:"Alle Logs"}}],ta=new O.Z({mode:"history",base:"/",routes:ea});ta.beforeEach((function(e,t,n){var a=e.query.access_token,r=K.getUser();function o(){ta.push({name:"start",query:{login:"true",return_url:window.location.origin+e.fullPath}})}null!=r?n():null!=a&&"string"===typeof a?K.setAccessToken(a).then((function(){console.log("Successful login!"),ta.push({path:e.path,query:{}})})).catch((function(e){console.log(e),o()})):"true"===e.query.login&&"start"==e.name?n():o()}));var na=ta,aa={name:"AppNavBar",components:{FormPopup:T},data:function(){return{loggedIn:!1,user:null}},methods:{checkLogin:function(){var e=this;this.loggedIn=null!=localStorage.getItem("access_token"),setTimeout((function(){e.loggedIn=null!=localStorage.getItem("access_token")}),200)},logout:function(){K.logout(),this.checkLogin(),na.push({name:"start"})}},watch:{loggedIn:function(){this.user=K.getUser()},$route:function(e){"true"===e.query.login?this.$refs.loginDialog.openDialog():this.$refs.loginDialog.closeDialog()}},beforeMount:function(){var e=this;this.checkLogin(),window.addEventListener("keywi-auth-change",(function(t){e.checkLogin()}))}},ra=aa,oa=(0,m.Z)(ra,p,h,!1,null,"3723310e",null),ia=oa.exports;x()(oa,{VIcon:$.Z});var sa={name:"AppHeader",components:{AppNavBar:ia,AppTitle:v}},la=sa,ca=(0,m.Z)(la,i,s,!1,null,"52356c69",null),ua=ca.exports,da=a.Z.extend({name:"App",components:{AppHeader:ua},data:function(){return{}},mounted:function(){this.$vuetify.theme.currentTheme.secondary="#41A6A0"}}),ma=da,fa=n(17524),va=n(99846),pa=n(81009),ha=(0,m.Z)(ma,r,o,!1,null,null,null),ka=ha.exports;x()(ha,{VApp:fa.Z,VContainer:va.Z,VMain:pa.Z});var ga=n(39132);a.Z.use(ga.Z);var ba=new ga.Z({icons:{iconfont:"mdi"}}),_a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-form",{ref:"form"},[n("v-text-field",{attrs:{"prepend-icon":"mdi-text",label:"Name",rules:e.nameRules,required:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),n("v-text-field",{attrs:{"prepend-icon":"mdi-map-marker",label:"Adresse"},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}}),n("v-text-field",{attrs:{"prepend-icon":"mdi-latitude",label:"Breitengrad (latitude)"},model:{value:e.lat,callback:function(t){e.lat=t},expression:"lat"}}),n("v-text-field",{attrs:{"prepend-icon":"mdi-longitude",label:"Längengrad (longitude)"},model:{value:e.lon,callback:function(t){e.lon=t},expression:"lon"}}),n("v-textarea",{attrs:{"prepend-icon":"mdi-note-text-outline",rows:"1",label:"Notiz"},model:{value:e.note,callback:function(t){e.note=t},expression:"note"}}),n("v-btn",{attrs:{color:"validate"},on:{click:e.save}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-content-save-outline")]),e._v(" Speichern ")],1)],1)},ya=[],xa={name:"AddLocationForm",data:function(){return{name:"",address:"",lat:void 0,lon:void 0,locationId:void 0,note:"",nameRules:[function(e){return!!e||"Name erforderlich"}]}},mounted:function(){this.$emit("mounted")},methods:{fillForm:function(e){e?(this.name=e.name,this.address=e.address,this.lat=e.latitude,this.lon=e.longitude,this.locationId=e.id,this.note=e.note):(this.name="",this.address="",this.lat=void 0,this.lon=void 0,this.locationId=void 0,this.note=""),this.$refs.form.resetValidation()},save:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()){t.next=6;break}return t.next=3,F;case 3:n=t.sent,a={name:e.name,address:e.address,latitude:e.lat,longitude:e.log,note:e.note},e.locationId?(r={uuid:e.locationId},n.location_editLocation(r,a).then((function(){e.$refs.form.reset(),e.$emit("save-form")}))):n.location_createLocation(null,a).then((function(){e.$refs.form.reset(),e.$emit("save-form")}));case 6:case"end":return t.stop()}}),t)})))()}}},Da=xa,wa=(0,m.Z)(Da,_a,ya,!1,null,"2df472e0",null),Sa=wa.exports;x()(wa,{VBtn:D.Z,VForm:ce.Z,VIcon:$.Z,VTextField:te.Z,VTextarea:de.Z});var Za=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-form",{ref:"form"},[n("v-autocomplete",{attrs:{"prepend-icon":"mdi-lock",items:e.locks,label:"Schloss","item-text":function(t){return e.getDisplayName(t)},"item-value":function(e){return e.id},rules:e.lockRule,"return-object":""},model:{value:e.selectedLock,callback:function(t){e.selectedLock=t},expression:"selectedLock"}}),n("v-text-field",{attrs:{"prepend-icon":"mdi-key",label:"Schlüsselnummer",rules:e.numberRules,required:""},model:{value:e.number,callback:function(t){e.number=t},expression:"number"}}),n("v-autocomplete",{attrs:{"prepend-icon":"mdi-safe-square-outline",items:e.safes,label:"Tresor","item-text":function(t){return e.getDisplayName(t)},"item-value":function(e){return e.id},rules:e.safeRule,"return-object":""},model:{value:e.selectedSafe,callback:function(t){e.selectedSafe=t},expression:"selectedSafe"}}),n("v-checkbox",{attrs:{label:"Ausleihbar"},model:{value:e.rentable,callback:function(t){e.rentable=t},expression:"rentable"}}),n("v-textarea",{attrs:{"prepend-icon":"mdi-note-text-outline",rows:"1",label:"Notiz"},model:{value:e.note,callback:function(t){e.note=t},expression:"note"}}),n("v-btn",{attrs:{color:"validate"},on:{click:e.save}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-content-save-outline")]),e._v(" Speichern ")],1)],1)},$a=[],Ea={name:"EditKeyForm",data:function(){return{number:"",locks:[],safes:[],selectedLock:void 0,selectedSafe:void 0,rentable:!0,note:"",keyId:void 0,numberRules:[function(e){return!!e||"Schlüsselnummer erforderlich"}],lockRule:[function(e){return!!e||"Bitte Schloss auswählen"}],safeRule:[function(e){return!!e||"Bitte Tresor auswählen"}]}},mounted:function(){this.loadData(),this.$emit("mounted")},methods:{fillForm:function(e){e?(this.keyId=e.id,this.number=e.number,this.rentable=e.rentable,this.selectedSafe=e.safe,this.selectedLock=e.lock,this.note=e.note):(this.keyId=void 0,this.number="",this.rentable=!0,this.selectedSafe=void 0,this.selectedLock=void 0,this.note=""),this.$refs.form.resetValidation()},getDisplayName:function(e){return e.location?e.name+" ("+e.location.name+")":e.name},save:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.$refs.form.validate()&&e.selectedLock&&e.selectedSafe)){t.next=6;break}return t.next=3,F;case 3:n=t.sent,a={number:e.number,lock_id:e.selectedLock.id,safe_id:e.selectedSafe.id,rentable:e.rentable,note:e.note},e.keyId?(r={uuid:e.keyId},n.key_editKey(r,a).then((function(){e.$refs.form.reset(),e.$emit("save-form")}))):n.key_createKey(null,a).then((function(t){e.$refs.form.reset(),e.keyId=t.data.id,e.$emit("save-form")}));case 6:case"end":return t.stop()}}),t)})))()},loadData:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,n.lock_getLocks().then((function(t){e.locks=t.data})).then(n.safe_getSafes).then((function(t){e.safes=t.data}));case 4:case"end":return t.stop()}}),t)})))()}}},Ta=Ea,Va=(0,m.Z)(Ta,Za,$a,!1,null,"3797cf22",null),Ca=Va.exports;x()(Va,{VAutocomplete:ie.Z,VBtn:D.Z,VCheckbox:se.Z,VForm:ce.Z,VIcon:$.Z,VTextField:te.Z,VTextarea:de.Z});var Ra=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-form",{ref:"form"},[n("v-text-field",{attrs:{"prepend-icon":"mdi-lock",label:"Name",rules:e.nameRules,required:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),n("v-text-field",{attrs:{"prepend-icon":"mdi-account",label:"Besitzer"},model:{value:e.owner,callback:function(t){e.owner=t},expression:"owner"}}),n("v-autocomplete",{attrs:{"prepend-icon":"mdi-map-marker",items:e.locations,label:"Ort","item-text":"name","item-value":"id",rules:e.selectRule,"return-object":""},model:{value:e.selectedLocation,callback:function(t){e.selectedLocation=t},expression:"selectedLocation"}}),n("v-textarea",{attrs:{"prepend-icon":"mdi-note-text-outline",rows:"1",label:"Notiz"},model:{value:e.note,callback:function(t){e.note=t},expression:"note"}}),n("v-btn",{attrs:{color:"validate"},on:{click:e.save}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-content-save-outline")]),e._v(" Speichern ")],1)],1)},Ia=[],La={name:"EditLockForm",data:function(){return{name:"",owner:void 0,locations:[],selectedLocation:void 0,note:"",nameRules:[function(e){return!!e||"Name erforderlich"}],selectRule:[function(e){return!!e||"Bitte Ort auswählen"}]}},mounted:function(){this.loadLocations(),this.$emit("mounted")},methods:{fillForm:function(e){e?(this.lockId=e.id,this.name=e.name,this.owner=e.owner,this.selectedLocation=e.location,this.note=e.note):(this.lockId=void 0,this.name="",this.owner="",this.selectedLocation=void 0,this.note=""),this.$refs.form.resetValidation()},save:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()||!e.selectedLocation){t.next=6;break}return t.next=3,F;case 3:n=t.sent,a={name:e.name,owner:e.owner,location_id:e.selectedLocation.id,note:e.note},e.lockId?(r={uuid:e.lockId},n.lock_editLock(r,a).then((function(){e.$refs.form.reset(),e.$emit("save-form")}))):n.lock_createLock(null,a).then((function(){e.$refs.form.reset(),e.$emit("save-form")}));case 6:case"end":return t.stop()}}),t)})))()},loadLocations:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,n.location_getLocations().then((function(t){e.locations=t.data}));case 4:case"end":return t.stop()}}),t)})))()}}},Aa=La,Ba=(0,m.Z)(Aa,Ra,Ia,!1,null,"b0b4f478",null),za=Ba.exports;x()(Ba,{VAutocomplete:ie.Z,VBtn:D.Z,VForm:ce.Z,VIcon:$.Z,VTextField:te.Z,VTextarea:de.Z});var Fa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-form",{ref:"form"},[n("v-text-field",{attrs:{"prepend-icon":"mdi-safe-square-outline",label:"Name",rules:e.nameRules,required:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),n("v-autocomplete",{attrs:{"prepend-icon":"mdi-map-marker",items:e.locations,label:"Ort","item-text":"name","item-value":"id",rules:e.selectRule,"return-object":""},model:{value:e.selectedLocation,callback:function(t){e.selectedLocation=t},expression:"selectedLocation"}}),n("v-textarea",{attrs:{"prepend-icon":"mdi-note-text-outline",rows:"1",label:"Notiz"},model:{value:e.note,callback:function(t){e.note=t},expression:"note"}}),n("v-btn",{attrs:{color:"validate"},on:{click:e.save}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-content-save-outline")]),e._v(" Speichern ")],1)],1)},Ua=[],Na={name:"EditSafeForm",data:function(){return{safeId:null,name:"",locations:[],selectedLocation:void 0,note:"",nameRules:[function(e){return!!e||"Name erforderlich"}],selectRule:[function(e){return!!e||"Bitte Ort auswählen"}]}},mounted:function(){this.loadLocations(),this.$emit("mounted")},methods:{fillForm:function(e){e?(this.safeId=e.id,this.name=e.name,this.selectedLocation=e.location,this.note=e.note):(this.safeId=void 0,this.name="",this.selectedLocation=void 0,this.note=""),this.$refs.form.resetValidation()},save:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()||!e.selectedLocation){t.next=6;break}return t.next=3,F;case 3:n=t.sent,a={name:e.name,location_id:e.selectedLocation.id,note:e.note},e.safeId?(r={uuid:e.safeId},n.safe_editSafe(r,a).then((function(){e.$refs.form.reset(),e.$emit("save-form")}))):n.safe_createSafe(null,a).then((function(){e.$refs.form.reset(),e.$emit("save-form")}));case 6:case"end":return t.stop()}}),t)})))()},loadLocations:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,n.location_getLocations().then((function(t){e.locations=t.data}));case 4:case"end":return t.stop()}}),t)})))()}}},Ka=Na,Oa=(0,m.Z)(Ka,Fa,Ua,!1,null,"6f218437",null),Pa=Oa.exports;x()(Oa,{VAutocomplete:ie.Z,VBtn:D.Z,VForm:ce.Z,VIcon:$.Z,VTextField:te.Z,VTextarea:de.Z});var Ma=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.error?n("v-alert",{attrs:{color:"red",type:"error"}},[e._v(" Nutzername oder Passwort falsch! ")]):e._e(),n("v-row",[n("v-col",{staticClass:"text-center"},[n("v-btn",{attrs:{block:"",color:"primary"},on:{click:e.loginWithOAuth}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-key")]),e._v(" Mit AG DSN Konto anmelden ")],1)],1)],1),n("v-row",[n("v-col",[n("v-divider")],1)],1),n("v-row",[n("v-col",[n("v-form",{ref:"form"},[n("v-text-field",{attrs:{rules:e.nameRules,label:"Nutzername","prepend-icon":"mdi-account",required:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),n("v-text-field",{attrs:{rules:e.passwordRules,label:"Passwort","prepend-icon":"mdi-key",required:"",type:"password"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login.apply(null,arguments)}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),n("v-row",[n("v-spacer"),n("v-btn",{staticClass:"mt-3",attrs:{color:"secondary"},on:{click:e.login}},[e._v(" Login ")])],1)],1)],1)],1)],1)},ja=[],qa={name:"LoginForm",data:function(){return{username:null,password:null,error:!1,nameRules:[function(e){return!!e||"Bitte Nutzernamen eingeben"}],passwordRules:[function(e){return!!e||"Bitte Password eingeben"}]}},methods:{login:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$refs.form.validate()){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,K.login(e.username,e.password);case 5:e.$refs.form.reset(),e.$emit("save-form"),e.$emit("submit"),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](2),e.error=!0;case 13:case"end":return t.stop()}}),t,null,[[2,10]])})))()},loginWithOAuth:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:window.location.href=K.getOAuthUrl(e.$route.query.return_url);case 1:case"end":return t.stop()}}),t)})))()}}},Ga=qa,Ja=(0,m.Z)(Ga,Ma,ja,!1,null,"1967bf2a",null),Wa=Ja.exports;x()(Ja,{VAlert:Ht.Z,VBtn:D.Z,VCol:Y.Z,VDivider:ke.Z,VForm:ce.Z,VIcon:$.Z,VRow:X.Z,VSpacer:ee.Z,VTextField:te.Z});var Ha=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-form",{ref:"form"},[n("v-autocomplete",{attrs:{"item-text":function(e){return e.name+" ("+e.email+")"},"return-object":"",items:e.users,label:"Vergeben an","prepend-icon":"mdi-account",rules:e.userRules},model:{value:e.pickedUser,callback:function(t){e.pickedUser=t},expression:"pickedUser"}}),n("v-text-field",{attrs:{"prepend-icon":"mdi-file-document",label:"Dokument"},model:{value:e.grantingDocument,callback:function(t){e.grantingDocument=t},expression:"grantingDocument"}}),n("v-textarea",{attrs:{"prepend-icon":"mdi-note-text-outline",rows:"1",label:"Notiz"},model:{value:e.note,callback:function(t){e.note=t},expression:"note"}}),n("v-checkbox",{attrs:{label:"Startdatum bearbeiten"},model:{value:e.editStartDate,callback:function(t){e.editStartDate=t},expression:"editStartDate"}}),n("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({staticStyle:{"margin-top":"-10px"},attrs:{disabled:!e.editStartDate,label:"Startdatum","prepend-icon":"mdi-calendar",readonly:""},model:{value:e.dateStart,callback:function(t){e.dateStart=t},expression:"dateStart"}},"v-text-field",r,!1),a))]}}]),model:{value:e.menuStartDate,callback:function(t){e.menuStartDate=t},expression:"menuStartDate"}},[n("v-date-picker",{on:{input:function(t){e.menuStartDate=!1}},model:{value:e.dateStart,callback:function(t){e.dateStart=t},expression:"dateStart"}})],1),n("v-checkbox",{attrs:{label:"Enddatum bearbeiten"},model:{value:e.editEndDate,callback:function(t){e.editEndDate=t},expression:"editEndDate"}}),n("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({staticStyle:{"margin-top":"-10px"},attrs:{disabled:!e.editEndDate,label:"Enddatum","prepend-icon":"mdi-calendar",readonly:""},model:{value:e.dateEnd,callback:function(t){e.dateEnd=t},expression:"dateEnd"}},"v-text-field",r,!1),a))]}}]),model:{value:e.menuEndDate,callback:function(t){e.menuEndDate=t},expression:"menuEndDate"}},[n("v-date-picker",{on:{input:function(t){e.menuEndDate=!1}},model:{value:e.dateEnd,callback:function(t){e.dateEnd=t},expression:"dateEnd"}})],1),n("v-btn",{attrs:{color:"secondary"},on:{click:e.save}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-content-save-outline")]),e._v(" Speichern ")],1)],1)},Ya=[],Qa={name:"RentKeyForm",data:function(){return{users:[],pickedUser:void 0,grantingDocument:"",note:"",menuStartDate:!1,editStartDate:!1,dateStart:void 0,menuEndDate:!1,editEndDate:!1,dateEnd:void 0,userRules:[function(e){return!!e||"Bitte Nutzer auswählen"}],keyId:void 0}},mounted:function(){this.loadUsers(),this.$emit("mounted")},methods:{setKeyId:function(e){this.keyId=e,this.$refs.form.resetValidation()},loadUsers:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,n.user_getUsers().then((function(t){e.users=t.data}));case 4:case"end":return t.stop()}}),t)})))()},dateToDatetime:function(e){return e+"T12:37"},save:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()){t.next=8;break}return t.next=3,F;case 3:n=t.sent,a={key_id:e.keyId,user_id:e.pickedUser.id,allowed_by:e.grantingDocument,note:e.note},e.editStartDate&&e.dateStart&&(a.begin=e.dateToDatetime(e.dateStart)),e.editEndDate&&e.dateEnd&&(a.end=e.dateToDatetime(e.dateEnd)),n.rental_createRental(null,a).then((function(){e.$emit("save-form")}));case 8:case"end":return t.stop()}}),t)})))()}}},Xa=Qa,er=(0,m.Z)(Xa,Ha,Ya,!1,null,"7bb49895",null),tr=er.exports;x()(er,{VAutocomplete:ie.Z,VBtn:D.Z,VCheckbox:se.Z,VDatePicker:le.Z,VForm:ce.Z,VIcon:$.Z,VMenu:ue.Z,VTextField:te.Z,VTextarea:de.Z});var nr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-form",{ref:"form"},[n("v-text-field",{attrs:{label:"Dokument","prepend-icon":"mdi-file-document"},model:{value:e.grantingDocument,callback:function(t){e.grantingDocument=t},expression:"grantingDocument"}}),n("v-textarea",{attrs:{label:"Notiz","prepend-icon":"mdi-note-text-outline",rows:"1"},model:{value:e.note,callback:function(t){e.note=t},expression:"note"}}),n("v-checkbox",{attrs:{label:"Startdatum bearbeiten"},model:{value:e.editStartDate,callback:function(t){e.editStartDate=t},expression:"editStartDate"}}),n("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({staticStyle:{"margin-top":"-10px"},attrs:{disabled:!e.editStartDate,label:"Startdatum","prepend-icon":"mdi-calendar",readonly:""},model:{value:e.dateStart,callback:function(t){e.dateStart=t},expression:"dateStart"}},"v-text-field",r,!1),a))]}}]),model:{value:e.menuStartDate,callback:function(t){e.menuStartDate=t},expression:"menuStartDate"}},[n("v-date-picker",{on:{input:function(t){e.menuStartDate=!1}},model:{value:e.dateStart,callback:function(t){e.dateStart=t},expression:"dateStart"}})],1),n("v-checkbox",{attrs:{label:"Enddatum bearbeiten"},model:{value:e.editEndDate,callback:function(t){e.editEndDate=t},expression:"editEndDate"}}),n("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({staticStyle:{"margin-top":"-10px"},attrs:{disabled:!e.editEndDate,label:"Enddatum","prepend-icon":"mdi-calendar",readonly:""},model:{value:e.dateEnd,callback:function(t){e.dateEnd=t},expression:"dateEnd"}},"v-text-field",r,!1),a))]}}]),model:{value:e.menuEndDate,callback:function(t){e.menuEndDate=t},expression:"menuEndDate"}},[n("v-date-picker",{on:{input:function(t){e.menuEndDate=!1}},model:{value:e.dateEnd,callback:function(t){e.dateEnd=t},expression:"dateEnd"}})],1),n("v-btn",{attrs:{color:"validate"},on:{click:e.save}},[n("v-icon",{attrs:{left:"",size:"24"}},[e._v("mdi-content-save-outline")]),e._v(" Speichern ")],1)],1)},ar=[],rr={name:"EditRentalForm",data:function(){return{rentalId:void 0,grantingDocument:"",note:"",menuStartDate:!1,editStartDate:!1,dateStart:void 0,menuEndDate:!1,editEndDate:!1,dateEnd:void 0}},mounted:function(){this.$emit("mounted")},methods:{fillForm:function(e){this.editStartDate=!1,this.editEndDate=!1,e?(this.rentalId=e.id,this.grantingDocument=e.allowed_by,this.note=e.note,e.begin&&(this.dateStart=this.datetimeToDate(e.begin)),e.end&&(this.dateEnd=this.datetimeToDate(e.end))):(this.rentalId=void 0,this.grantingDocument="",this.note=""),this.$refs.form.resetValidation()},dateToDatetime:function(e){return e+"T12:37"},datetimeToDate:function(e){return e.substring(0,e.indexOf("T"))},save:function(){var e=this;return(0,V.Z)(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F;case 2:n=t.sent,a={allowed_by:e.grantingDocument,note:e.note},e.editStartDate&&e.dateStart&&(a.begin=e.dateToDatetime(e.dateStart)),e.editEndDate&&e.dateEnd&&(a.end=e.dateToDatetime(e.dateEnd)),e.rentalId?(r={uuid:e.rentalId},n.rental_editRental(r,a).then((function(){e.$refs.form.reset(),e.$emit("save-form")}))):n.rental_createRental(null,a).then((function(){e.$refs.form.reset(),e.$emit("save-form")}));case 7:case"end":return t.stop()}}),t)})))()}}},or=rr,ir=(0,m.Z)(or,nr,ar,!1,null,"706ed13d",null),sr=ir.exports;x()(ir,{VBtn:D.Z,VCheckbox:se.Z,VDatePicker:le.Z,VForm:ce.Z,VIcon:$.Z,VMenu:ue.Z,VTextField:te.Z,VTextarea:de.Z}),a.Z.config.productionTip=!1,a.Z.component("edit-location-form",Sa),a.Z.component("edit-key-form",Ca),a.Z.component("edit-lock-form",za),a.Z.component("edit-safe-form",Pa),a.Z.component("edit-rental-form",sr),a.Z.component("login-form",Wa),a.Z.component("rent-key-form",tr),new a.Z({router:na,vuetify:ba,render:function(e){return e(ka)}}).$mount("#app")},33471:function(){},52361:function(){},94616:function(){}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var o=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,function(){var e=[];n.O=function(t,a,r,o){if(!a){var i=1/0;for(u=0;u<e.length;u++){a=e[u][0],r=e[u][1],o=e[u][2];for(var s=!0,l=0;l<a.length;l++)(!1&o||i>=o)&&Object.keys(n.O).every((function(e){return n.O[e](a[l])}))?a.splice(l--,1):(s=!1,o<i&&(i=o));if(s){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[a,r,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.hmd=function(e){return e=Object.create(e),e.children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e}}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var r,o,i=a[0],s=a[1],l=a[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(l)var u=l(n)}for(t&&t(a);c<i.length;c++)o=i[c],n.o(e,o)&&e[o]&&e[o][0](),e[i[c]]=0;return n.O(u)},a=self["webpackChunkkeywi"]=self["webpackChunkkeywi"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(55726)}));a=n.O(a)})();
//# sourceMappingURL=app-legacy.4a1dcf17.js.map